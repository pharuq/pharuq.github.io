!function(){"use strict";function e(e){var r,n,a,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,a=Symbol.iterator);i--;){if(n&&null!=(r=e[n]))return r.call(e);if(a&&null!=(r=e[a]))return new t(r.call(e));n="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function t(e){function r(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return t=function(e){this.s=e,this.n=e.next},t.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):r(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):r(t.apply(this.s,arguments))}},new t(e)}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e){this.wrapped=e}function i(e){var t,r;function n(t,r){try{var o=e[t](r),s=o.value,u=s instanceof a;Promise.resolve(u?s.wrapped:s).then((function(e){u?n("return"===t?"return":"next",e):i(o.done?"return":"normal",e)}),(function(e){n("throw",e)}))}catch(e){i("throw",e)}}function i(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,a){return new Promise((function(i,o){var s={key:e,arg:a,resolve:i,reject:o,next:null};r?r=r.next=s:(t=r=s,n(e,a))}))},"function"!=typeof e.return&&(this.return=void 0)}function o(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,u,"next",e)}function u(e){o(i,n,a,s,u,"throw",e)}s(void 0)}))}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=v(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)};var y,b="/repro/cache",k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var a=t&&t.prototype instanceof m?t:m,i=Object.create(a.prototype),o=new E(n||[]);return i._invoke=function(e,t,r){var n=h;return function(a,i){if(n===f)throw new Error("Generator is already running");if(n===d){if("throw"===a)throw i;return A()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=S(o,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var u=l(e,t,r);if("normal"===u.type){if(n=r.done?d:p,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=d,r.method="throw",r.arg=u.arg)}}}(e,r,o),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",f="executing",d="completed",v={};function m(){}function g(){}function y(){}var b={};u(b,i,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(O([])));x&&x!==r&&n.call(x,i)&&(b=x);var w=y.prototype=m.prototype=Object.create(b);function R(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(a,i,o,s){var u=l(e[a],e,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,s)}))}s(u.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function S(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var a=l(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function O(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:A}}function A(){return{value:t,done:!0}}return g.prototype=y,u(w,"constructor",y),u(y,"constructor",g),g.displayName=u(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},R(C.prototype),u(C.prototype,o,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,a,i){void 0===i&&(i=Promise);var o=new C(c(t,r,n,a),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},R(w),u(w,s,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=O,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;M(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}({exports:{}}),y=Symbol.iterator;var x=function(){function e(){u(this,e),h(this,"_length",0),h(this,"st1",[]),h(this,"st2",[])}return l(e,[{key:"length",get:function(){return this._length},set:function(e){0===e&&(this.st1.length=0,this.st2.length=0)}},{key:y,value:regeneratorRuntime.mark((function e(){var t,r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.st2.slice(),r=t.length-1;case 2:if(!(r>=0)){e.next=8;break}return e.next=5,t[r];case 5:r--,e.next=2;break;case 8:n=g(this.st1),e.prev=9,n.s();case 11:if((a=n.n()).done){e.next=17;break}return i=a.value,e.next=15,i;case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),n.e(e.t0);case 22:return e.prev=22,n.f(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[9,19,22,25]])}))},{key:"entries",value:function(){var e,t=this,r=1,n=0,a=0;return h(e={},Symbol.iterator,(function(){return this})),h(e,"next",(function(){return t.st2.length>=r?{value:[a++,t.st2[t.st2.length-r++]],done:!1}:t.st2.length<=r&&!t.st1.length?{value:void 0,done:!0}:t.st1.length>n?{value:[a++,t.st1[n++]],done:!1}:{value:void 0,done:!0}})),e}},{key:"peek",value:function(){return this.st2.length?this.st2[this.st2.length-1]:this.st1[0]}},{key:"pop",value:function(){if(this._length>0&&this._length--,this.st2.length)return this.st2.pop();for(;this.st1.length;)this.st2.push(this.st1.pop());return this.st2.pop()}},{key:"push",value:function(e){this.st1.push(e),this._length++}},{key:"toArray",value:function(){for(var e=[],t=this.st2.length-1;t>=0;t--)e.push(this.st2[t]);return e.concat(this.st1)}}]),e}(),w={js:1,css:2,document:3,image:4,font:5,unknown:6};const R="2.22.2001",C="1.1.1";var S,P,M=function(e,t){var r=new x,n=new x,a=0,i=function(){var o=s(regeneratorRuntime.mark((function o(u,c){var l,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!e.isLocked()){o.next=2;break}return o.abrupt("return",new Promise((function(e,t){var n;r.push({job:(n=s(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,i(u,c);case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)}),reject:t,id:c||"".concat(Date.now())})})));case 2:return t&&e.lock(),a++,o.prev=4,o.next=7,u();case 7:l=o.sent,o.next=13;break;case 10:o.prev=10,o.t0=o.catch(4),h=o.t0;case 13:if(a--,n.length?a||n.pop()():t&&e.isLocked()?setTimeout((function(){e.unlock(),r.length&&r.pop().job()}),10):t||e.isLocked()||setTimeout(i.drain,10),!l&&h){o.next=17;break}return o.abrupt("return",l);case 17:return o.abrupt("return",Promise.reject(h));case 18:case"end":return o.stop()}}),o,null,[[4,10]])})));return function(e,t){return o.apply(this,arguments)}}();return i.drain=function(){r.length&&r.pop().job()},i.isLocked=function(){return e.isLocked()},i.lockAfterAllProcessingExit=s(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t||!e.isLocked()&&!n.length){r.next=2;break}return r.abrupt("return");case 2:if(!a){r.next=4;break}return r.abrupt("return",new Promise((function(t){return n.push((function(){e.lock(),t()}))})));case 4:e.lock();case 5:case"end":return r.stop()}}),r)}))),i.discardPendingJob=function(){var t=s(regeneratorRuntime.mark((function t(n){var a,o,s,u,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.lockAfterAllProcessingExit();case 2:if(n){a=new x,o=g(r);try{for(o.s();!(s=o.n()).done;)(u=s.value).id===n?u.reject("Discarded"):a.push(u),r.length=0,r=a}catch(e){o.e(e)}finally{o.f()}}else{c=g(r);try{for(c.s();!(l=c.n()).done;)l.value.reject("Discarded")}catch(e){c.e(e)}finally{c.f()}r.length=0}e.unlock();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i},E=function(){var e=!1;return M({lock:function(){e=!0},unlock:function(){e=!1},isLocked:function(){return e}},!0)},O={exports:{}};
/*!
   * Platform.js v1.3.6
   * Copyright 2014-2020 Benjamin Tan
   * Copyright 2011-2013 John-David Dalton
   * Available under MIT license
   */
S=O,P=O.exports,function(){var e={function:!0,object:!0}[typeof window]&&window||this,t=P,r=S&&!S.nodeType&&S,n=t&&r&&"object"==typeof k&&k;!n||n.global!==n&&n.window!==n&&n.self!==n||(e=n);var a=Math.pow(2,53)-1,i=/\bOpera/,o=Object.prototype,s=o.hasOwnProperty,u=o.toString;function c(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function l(e){return e=v(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:c(e)}function h(e,t){for(var r in e)s.call(e,r)&&t(e[r],r,e)}function p(e){return null==e?c(e):u.call(e).slice(8,-1)}function f(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function d(e,t){var r=null;return function(e,t){var r=-1,n=e?e.length:0;if("number"==typeof n&&n>-1&&n<=a)for(;++r<n;)t(e[r],r,e);else h(e,t)}(e,(function(n,a){r=t(r,n,a,e)})),r}function v(e){return String(e).replace(/^ +| +$/g,"")}var m=function t(r){var n=e,a=r&&"object"==typeof r&&"String"!=p(r);a&&(n=r,r=null);var o=n.navigator||{},s=o.userAgent||"";r||(r=s);var c,m,g,y,b,k=a?!!o.likeChrome:/\bChrome\b/.test(r)&&!/internal|\n/i.test(u.toString()),x="Object",w=a?x:"ScriptBridgingProxyObject",R=a?x:"Environment",C=a&&n.java?"JavaPackage":p(n.java),S=a?x:"RuntimeObject",P=/\bJava/.test(C)&&n.java,M=P&&p(n.environment)==R,E=P?"a":"α",O=P?"b":"β",A=n.document||{},L=n.operamini||n.opera,z=i.test(z=a&&L?L["[[Class]]"]:p(L))?z:L=null,I=r,_=[],T=null,q=r==s,j=q&&L&&"function"==typeof L.version&&L.version(),N=d([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,t){return e||RegExp("\\b"+(t.pattern||f(t))+"\\b","i").exec(r)&&(t.label||t)})),B=function(e){return d(e,(function(e,t){return e||RegExp("\\b"+(t.pattern||f(t))+"\\b","i").exec(r)&&(t.label||t)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),H=F([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),U=function(e){return d(e,(function(e,t,n){return e||(t[H]||t[/^[a-z]+(?: +[a-z]+\b)*/i.exec(H)]||RegExp("\\b"+f(n)+"(?:\\b|\\w*\\d)","i").exec(r))&&n}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),D=function(e){return d(e,(function(e,t){var n=t.pattern||f(t);return!e&&(e=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(r))&&(e=function(e,t,r){var n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&r&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&r&&(e=e.replace(RegExp(t,"i"),r)),l(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,n,t.label||t)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function F(e){return d(e,(function(e,t){var n=t.pattern||f(t);return!e&&(e=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(r)||RegExp("\\b"+n+" *\\w+-[\\w]*","i").exec(r)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(r))&&((e=String(t.label&&!RegExp(n,"i").test(t.label)?t.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),t=t.label||t,e=l(e[0].replace(RegExp(n,"i"),t).replace(RegExp("; *(?:"+t+"[_-])?","i")," ").replace(RegExp("("+t+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function W(e){return d(e,(function(e,t){return e||(RegExp(t+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(r)||0)[1]||null}))}if(N&&(N=[N]),/\bAndroid\b/.test(D)&&!H&&(c=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(r))&&(H=v(c[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),U&&!H?H=F([U]):U&&H&&(H=H.replace(RegExp("^("+f(U)+")[-_.\\s]","i"),U+" ").replace(RegExp("^("+f(U)+")[-_.]?(\\w)","i"),U+" $2")),(c=/\bGoogle TV\b/.exec(H))&&(H=c[0]),/\bSimulator\b/i.test(r)&&(H=(H?H+" ":"")+"Simulator"),"Opera Mini"==B&&/\bOPiOS\b/.test(r)&&_.push("running in Turbo/Uncompressed mode"),"IE"==B&&/\blike iPhone OS\b/.test(r)?(U=(c=t(r.replace(/like iPhone OS/,""))).manufacturer,H=c.product):/^iP/.test(H)?(B||(B="Safari"),D="iOS"+((c=/ OS ([\d_]+)/i.exec(r))?" "+c[1].replace(/_/g,"."):"")):"Konqueror"==B&&/^Linux\b/i.test(D)?D="Kubuntu":U&&"Google"!=U&&(/Chrome/.test(B)&&!/\bMobile Safari\b/i.test(r)||/\bVita\b/.test(H))||/\bAndroid\b/.test(D)&&/^Chrome/.test(B)&&/\bVersion\//i.test(r)?(B="Android Browser",D=/\bAndroid\b/.test(D)?D:"Android"):"Silk"==B?(/\bMobi/i.test(r)||(D="Android",_.unshift("desktop mode")),/Accelerated *= *true/i.test(r)&&_.unshift("accelerated")):"UC Browser"==B&&/\bUCWEB\b/.test(r)?_.push("speed mode"):"PaleMoon"==B&&(c=/\bFirefox\/([\d.]+)\b/.exec(r))?_.push("identifying as Firefox "+c[1]):"Firefox"==B&&(c=/\b(Mobile|Tablet|TV)\b/i.exec(r))?(D||(D="Firefox OS"),H||(H=c[1])):!B||(c=!/\bMinefield\b/i.test(r)&&/\b(?:Firefox|Safari)\b/.exec(B))?(B&&!H&&/[\/,]|^[^(]+?\)/.test(r.slice(r.indexOf(c+"/")+8))&&(B=null),(c=H||U||D)&&(H||U||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(D))&&(B=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(D)?D:c)+" Browser")):"Electron"==B&&(c=(/\bChrome\/([\d.]+)\b/.exec(r)||0)[1])&&_.push("Chromium "+c),j||(j=W(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",f(B),"(?:Firefox|Minefield|NetFront)"])),(c=("iCab"==N&&parseFloat(j)>3?"WebKit":/\bOpera\b/.test(B)&&(/\bOPR\b/.test(r)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(r)&&!/^(?:Trident|EdgeHTML)$/.test(N)&&"WebKit"||!N&&/\bMSIE\b/i.test(r)&&("Mac OS"==D?"Tasman":"Trident")||"WebKit"==N&&/\bPlayStation\b(?! Vita\b)/i.test(B)&&"NetFront")&&(N=[c]),"IE"==B&&(c=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(r)||0)[1])?(B+=" Mobile",D="Windows Phone "+(/\+$/.test(c)?c:c+".x"),_.unshift("desktop mode")):/\bWPDesktop\b/i.test(r)?(B="IE Mobile",D="Windows Phone 8.x",_.unshift("desktop mode"),j||(j=(/\brv:([\d.]+)/.exec(r)||0)[1])):"IE"!=B&&"Trident"==N&&(c=/\brv:([\d.]+)/.exec(r))&&(B&&_.push("identifying as "+B+(j?" "+j:"")),B="IE",j=c[1]),q){if(y="global",b=null!=(g=n)?typeof g[y]:"number",/^(?:boolean|number|string|undefined)$/.test(b)||"object"==b&&!g[y])p(c=n.runtime)==w?(B="Adobe AIR",D=c.flash.system.Capabilities.os):p(c=n.phantom)==S?(B="PhantomJS",j=(c=c.version||null)&&c.major+"."+c.minor+"."+c.patch):"number"==typeof A.documentMode&&(c=/\bTrident\/(\d+)/i.exec(r))?(j=[j,A.documentMode],(c=+c[1]+4)!=j[1]&&(_.push("IE "+j[1]+" mode"),N&&(N[1]=""),j[1]=c),j="IE"==B?String(j[1].toFixed(1)):j[0]):"number"==typeof A.documentMode&&/^(?:Chrome|Firefox)\b/.test(B)&&(_.push("masking as "+B+" "+j),B="IE",j="11.0",N=["Trident"],D="Windows");else if(P&&(I=(c=P.lang.System).getProperty("os.arch"),D=D||c.getProperty("os.name")+" "+c.getProperty("os.version")),M){try{j=n.require("ringo/engine").version.join("."),B="RingoJS"}catch(e){(c=n.system)&&c.global.system==n.system&&(B="Narwhal",D||(D=c[0].os||null))}B||(B="Rhino")}else"object"==typeof n.process&&!n.process.browser&&(c=n.process)&&("object"==typeof c.versions&&("string"==typeof c.versions.electron?(_.push("Node "+c.versions.node),B="Electron",j=c.versions.electron):"string"==typeof c.versions.nw&&(_.push("Chromium "+j,"Node "+c.versions.node),B="NW.js",j=c.versions.nw)),B||(B="Node.js",I=c.arch,D=c.platform,j=(j=/[\d.]+/.exec(c.version))?j[0]:null));D=D&&l(D)}if(j&&(c=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(j)||/(?:alpha|beta)(?: ?\d)?/i.exec(r+";"+(q&&o.appMinorVersion))||/\bMinefield\b/i.test(r)&&"a")&&(T=/b/i.test(c)?"beta":"alpha",j=j.replace(RegExp(c+"\\+?$"),"")+("beta"==T?O:E)+(/\d+\+?/.exec(c)||"")),"Fennec"==B||"Firefox"==B&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(D))B="Firefox Mobile";else if("Maxthon"==B&&j)j=j.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(H))"Xbox 360"==H&&(D=null),"Xbox 360"==H&&/\bIEMobile\b/.test(r)&&_.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(B)&&(!B||H||/Browser|Mobi/.test(B))||"Windows CE"!=D&&!/Mobi/i.test(r))if("IE"==B&&q)try{null===n.external&&_.unshift("platform preview")}catch(e){_.unshift("embedded")}else(/\bBlackBerry\b/.test(H)||/\bBB10\b/.test(r))&&(c=(RegExp(H.replace(/ +/g," *")+"/([.\\d]+)","i").exec(r)||0)[1]||j)?(D=((c=[c,/BB10/.test(r)])[1]?(H=null,U="BlackBerry"):"Device Software")+" "+c[0],j=null):this!=h&&"Wii"!=H&&(q&&L||/Opera/.test(B)&&/\b(?:MSIE|Firefox)\b/i.test(r)||"Firefox"==B&&/\bOS X (?:\d+\.){2,}/.test(D)||"IE"==B&&(D&&!/^Win/.test(D)&&j>5.5||/\bWindows XP\b/.test(D)&&j>8||8==j&&!/\bTrident\b/.test(r)))&&!i.test(c=t.call(h,r.replace(i,"")+";"))&&c.name&&(c="ing as "+c.name+((c=c.version)?" "+c:""),i.test(B)?(/\bIE\b/.test(c)&&"Mac OS"==D&&(D=null),c="identify"+c):(c="mask"+c,B=z?l(z.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(c)&&(D=null),q||(j=null)),N=["Presto"],_.push(c));else B+=" Mobile";(c=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(r)||0)[1])&&(c=[parseFloat(c.replace(/\.(\d)$/,".0$1")),c],"Safari"==B&&"+"==c[1].slice(-1)?(B="WebKit Nightly",T="alpha",j=c[1].slice(0,-1)):j!=c[1]&&j!=(c[2]=(/\bSafari\/([\d.]+\+?)/i.exec(r)||0)[1])||(j=null),c[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(r)||0)[1],537.36==c[0]&&537.36==c[2]&&parseFloat(c[1])>=28&&"WebKit"==N&&(N=["Blink"]),q&&(k||c[1])?(N&&(N[1]="like Chrome"),c=c[1]||((c=c[0])<530?1:c<532?2:c<532.05?3:c<533?4:c<534.03?5:c<534.07?6:c<534.1?7:c<534.13?8:c<534.16?9:c<534.24?10:c<534.3?11:c<535.01?12:c<535.02?"13+":c<535.07?15:c<535.11?16:c<535.19?17:c<536.05?18:c<536.1?19:c<537.01?20:c<537.11?"21+":c<537.13?23:c<537.18?24:c<537.24?25:c<537.36?26:"Blink"!=N?"27":"28")):(N&&(N[1]="like Safari"),c=(c=c[0])<400?1:c<500?2:c<526?3:c<533?4:c<534?"4+":c<535?5:c<537?6:c<538?7:c<601?8:c<602?9:c<604?10:c<606?11:c<608?12:"12"),N&&(N[1]+=" "+(c+="number"==typeof c?".x":/[.+]/.test(c)?"":"+")),"Safari"==B&&(!j||parseInt(j)>45)?j=c:"Chrome"==B&&/\bHeadlessChrome/i.test(r)&&_.unshift("headless")),"Opera"==B&&(c=/\bzbov|zvav$/.exec(D))?(B+=" ",_.unshift("desktop mode"),"zvav"==c?(B+="Mini",j=null):B+="Mobile",D=D.replace(RegExp(" *"+c+"$"),"")):"Safari"==B&&/\bChrome\b/.exec(N&&N[1])?(_.unshift("desktop mode"),B="Chrome Mobile",j=null,/\bOS X\b/.test(D)?(U="Apple",D="iOS 4.3+"):D=null):/\bSRWare Iron\b/.test(B)&&!j&&(j=W("Chrome")),j&&0==j.indexOf(c=/[\d.]+$/.exec(D))&&r.indexOf("/"+c+"-")>-1&&(D=v(D.replace(c,""))),D&&-1!=D.indexOf(B)&&!RegExp(B+" OS").test(D)&&(D=D.replace(RegExp(" *"+f(B)+" *"),"")),N&&!/\b(?:Avant|Nook)\b/.test(B)&&(/Browser|Lunascape|Maxthon/.test(B)||"Safari"!=B&&/^iOS/.test(D)&&/\bSafari\b/.test(N[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(B)&&N[1])&&(c=N[N.length-1])&&_.push(c),_.length&&(_=["("+_.join("; ")+")"]),U&&H&&H.indexOf(U)<0&&_.push("on "+U),H&&_.push((/^on /.test(_[_.length-1])?"":"on ")+H),D&&(c=/ ([\d.+]+)$/.exec(D),m=c&&"/"==D.charAt(D.length-c[0].length-1),D={architecture:32,family:c&&!m?D.replace(c[0],""):D,version:c?c[1]:null,toString:function(){var e=this.version;return this.family+(e&&!m?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(c=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(I))&&!/\bi686\b/i.test(I)?(D&&(D.architecture=64,D.family=D.family.replace(RegExp(" *"+c),"")),B&&(/\bWOW64\b/i.test(r)||q&&/\w(?:86|32)$/.test(o.cpuClass||o.platform)&&!/\bWin64; x64\b/i.test(r))&&_.unshift("32-bit")):D&&/^OS X/.test(D.family)&&"Chrome"==B&&parseFloat(j)>=39&&(D.architecture=64),r||(r=null);var G={};return G.description=r,G.layout=N&&N[0],G.manufacturer=U,G.name=B,G.prerelease=T,G.product=H,G.ua=r,G.version=B&&j,G.os=D||{architecture:null,family:null,version:null,toString:function(){return"null"}},G.parse=t,G.toString=function(){return this.description||""},G.version&&_.unshift(j),G.name&&_.unshift(B),D&&B&&(D!=String(D).split(" ")[0]||D!=B.split(" ")[0]&&!H)&&_.push(H?"("+D+")":"on "+D),_.length&&(G.description=_.join(" ")),G}();t&&r?h(m,(function(e,r){t[r]=e})):e.platform=m}.call(k);var A=O.exports,L=function(e){var t=e.os,r=e.product;if("Android"===t.family)return!0;switch(r){case"iPhone":case"iPod":case"iPad":return!0;default:return!1}},z={js:36e5,css:36e5,document:864e5,image:864e5,font:864e5,unknown:18e5},I={appId:0,userAnnotation:"",idfv:"",isFirstSession:!1,token:""},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n({available:!1,cacheLimit:1e7,opaqueCacheLimit:5e8,cacheConfig:z,viewportStayTimeThreshold:500,viewportRootMargins:["0px"],serviceWorkerUrl:"site-sw.js",serviceWorkerScope:"/",prefetchingExclusionFilter:[],filter:{includes:[],excludes:[]},cacheBustingTriggerUrl:[],mouseoverTimeout:500,unregisterOnStop:!0,configApiRequestParameters:I,controlGroupRate:0,googleAnalyticsTrackingCode:"",allowWebview:!1,ga4MeasurementId:"",ga4MeasurementIdForClient:"",ga4SiteSpeedSampleRate:0,addHeaderToPrefetch:!1,addQueryParamToPrefetch:!1,trafficAmount:{short:0,long:0},proxyConfig:{imageProxy:{active:!1,filters:{includes:[],excludes:[]},cacheRevision:0,hosts:[],timeout:0,optimization:{formatConvertion:!1}}},prefetchPostback:{active:!1,addHeaderToPostback:!1,addQueryParamToPostback:!1,filters:{includes:[],excludes:[]}}},e)},T=function(e){return L({os:A.os,product:A.product})?e.mobile:e.desktop},q={desktop:_(),mobile:_(),shared:_()},j=n(n({},T(q)),{},{configApiRequestParameters:I}),N=function(e){return e?e.flatMap((function(e){return e.matchWith&&e.value&&e.cacheDeleteConditions&&e.method?[{matchWith:e.matchWith,value:e.value,method:e.method,isNavigationOnly:e.isNavigationOnly,cacheDeleteConditions:e.cacheDeleteConditions}]:[]})):j.cacheBustingTriggerUrl},B=function(){var e,t,r,n,a,i,o,s,u,c,l,h,p,f,d,v,m,g,y,b,k,x,w,R,C,S,P,M,E,O,A,L,z,_,T,q,B,H,U,D,F,W,G,Q,K,$,X,J,V,Z,Y,ee,te,re,ne,ae,ie,oe,se,ue=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{available:null!=ue.available?ue.available:j.available,cacheLimit:null!=ue.cacheLimit?ue.cacheLimit:j.cacheLimit,opaqueCacheLimit:null!=ue.opaqueCacheLimit?ue.opaqueCacheLimit:j.opaqueCacheLimit,cacheConfig:{js:ue.cacheConfig&&null!=ue.cacheConfig.js?ue.cacheConfig.js:j.cacheConfig.js,css:ue.cacheConfig&&null!=ue.cacheConfig.css?ue.cacheConfig.css:j.cacheConfig.css,document:ue.cacheConfig&&null!=ue.cacheConfig.document?ue.cacheConfig.document:j.cacheConfig.document,image:ue.cacheConfig&&null!=ue.cacheConfig.image?ue.cacheConfig.image:j.cacheConfig.image,font:ue.cacheConfig&&null!=ue.cacheConfig.font?ue.cacheConfig.font:j.cacheConfig.font,unknown:ue.cacheConfig&&null!=ue.cacheConfig.unknown?ue.cacheConfig.unknown:j.cacheConfig.unknown},viewportStayTimeThreshold:null!==(e=ue.viewportStayTimeThreshold)&&void 0!==e?e:j.viewportStayTimeThreshold,viewportRootMargins:null!==(t=null==ue||null===(r=ue.viewportRootMargins)||void 0===r||null===(n=r.filter)||void 0===n?void 0:n.call(r,(function(e){return null!=e})))&&void 0!==t?t:j.viewportRootMargins,controlGroupRate:null!==(a=ue.controlGroupRate)&&void 0!==a?a:j.controlGroupRate,googleAnalyticsTrackingCode:null!==(i=ue.googleAnalyticsTrackingCode)&&void 0!==i?i:j.googleAnalyticsTrackingCode,ga4MeasurementId:null!==(o=ue.ga4MeasurementId)&&void 0!==o?o:j.ga4MeasurementId,ga4MeasurementIdForClient:null!==(s=ue.ga4MeasurementIdForClient)&&void 0!==s?s:j.ga4MeasurementIdForClient,ga4SiteSpeedSampleRate:null!==(u=ue.ga4SiteSpeedSampleRate)&&void 0!==u?u:j.ga4SiteSpeedSampleRate,serviceWorkerUrl:ue.serviceWorkerUrl||j.serviceWorkerUrl,serviceWorkerScope:ue.serviceWorkerScope||j.serviceWorkerScope,unregisterOnStop:null!==(c=ue.unregisterOnStop)&&void 0!==c?c:j.unregisterOnStop,prefetchingExclusionFilter:null!==(l=ue.prefetchingExclusionFilter)&&void 0!==l?l:j.prefetchingExclusionFilter,filter:null!==(h=ue.filter)&&void 0!==h?h:j.filter,mouseoverTimeout:null!==(p=ue.mouseoverTimeout)&&void 0!==p?p:j.mouseoverTimeout,cacheBustingTriggerUrl:N(ue.cacheBustingTriggerUrl),allowWebview:null!==(f=ue.allowWebview)&&void 0!==f?f:j.allowWebview,addHeaderToPrefetch:null!==(d=ue.addHeaderToPrefetch)&&void 0!==d&&d,addQueryParamToPrefetch:null!==(v=ue.addQueryParamToPrefetch)&&void 0!==v&&v,trafficAmount:{long:null!==(m=null==ue||null===(g=ue.trafficAmount)||void 0===g?void 0:g.long)&&void 0!==m?m:j.trafficAmount.long,short:null!==(y=null==ue||null===(b=ue.trafficAmount)||void 0===b?void 0:b.short)&&void 0!==y?y:j.trafficAmount.short},proxyConfig:{imageProxy:{active:(null==ue||null===(k=ue.proxyConfig)||void 0===k||null===(x=k.imageProxy)||void 0===x?void 0:x.active)||!1,hosts:null!==(w=null==ue||null===(R=ue.proxyConfig)||void 0===R||null===(C=R.imageProxy)||void 0===C?void 0:C.hosts)&&void 0!==w?w:[],filters:null!==(S=null===(P=ue.proxyConfig)||void 0===P||null===(M=P.imageProxy)||void 0===M?void 0:M.filters)&&void 0!==S?S:j.proxyConfig.imageProxy.filters,cacheRevision:null!==(E=null===(O=ue.proxyConfig)||void 0===O||null===(A=O.imageProxy)||void 0===A?void 0:A.cacheRevision)&&void 0!==E?E:j.proxyConfig.imageProxy.cacheRevision,timeout:null!==(L=null===(z=ue.proxyConfig)||void 0===z||null===(_=z.imageProxy)||void 0===_?void 0:_.timeout)&&void 0!==L?L:j.proxyConfig.imageProxy.timeout,optimization:{formatConvertion:null!==(T=null===(q=ue.proxyConfig)||void 0===q||null===(B=q.imageProxy)||void 0===B||null===(H=B.optimization)||void 0===H?void 0:H.formatConvertion)&&void 0!==T?T:j.proxyConfig.imageProxy.optimization.formatConvertion}}},prefetchPostback:{active:!(null===(U=ue.prefetchPostback)||void 0===U||!U.active),filters:{includes:null!==(D=null===(F=ue.prefetchPostback)||void 0===F||null===(W=F.filters)||void 0===W?void 0:W.includes)&&void 0!==D?D:[],excludes:null!==(G=null===(Q=ue.prefetchPostback)||void 0===Q||null===(K=Q.filters)||void 0===K?void 0:K.excludes)&&void 0!==G?G:[]},addHeaderToPostback:null!==($=null===(X=ue.prefetchPostback)||void 0===X?void 0:X.addHeaderToPostback)&&void 0!==$&&$,addQueryParamToPostback:null!==(J=null===(V=ue.prefetchPostback)||void 0===V?void 0:V.addQueryParamToPostback)&&void 0!==J&&J},configApiRequestParameters:{appId:null!==(Z=null===(Y=ue.configApiRequestParameters)||void 0===Y?void 0:Y.appId)&&void 0!==Z?Z:I.appId,userAnnotation:null!==(ee=null===(te=ue.configApiRequestParameters)||void 0===te?void 0:te.userAnnotation)&&void 0!==ee?ee:I.userAnnotation,idfv:null!==(re=null===(ne=ue.configApiRequestParameters)||void 0===ne?void 0:ne.idfv)&&void 0!==re?re:I.idfv,isFirstSession:null!==(ae=null===(ie=ue.configApiRequestParameters)||void 0===ie?void 0:ie.isFirstSession)&&void 0!==ae?ae:I.isFirstSession,token:null!==(oe=null===(se=ue.configApiRequestParameters)||void 0===se?void 0:se.token)&&void 0!==oe?oe:I.token}}},H=function(e,t){return B(n(n({},e),{},{configApiRequestParameters:t}))},U="".concat(self.location.origin,"/precacher.repro.io/config"),D="".concat(U,"/gcindex"),F="".concat(U,"/gcindex_doc"),W="".concat(U,"/gcindex_opaque"),G="".concat(U,"/fetch_configuration_history"),Q="".concat(U,"/ec/serialization"),K="".concat(U,"/chr"),$="".concat(U,"/cl"),X=5e6;new Response("",{status:200});var J,V,Z,Y="precacher-root-cache-key",ee="rpr-precacher",te="x-repro-response-size",re={accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8"},ne="rpr_prefetch",ae=null!==(J=A.name)&&void 0!==J&&J.includes("Safari")&&parseFloat(null!==(V=A.version)&&void 0!==V?V:"0")<14?{}:null!==(Z=A.name)&&void 0!==Z&&Z.includes("Safari")?{jpg:"webp",jpeg:"webp",png:"webp"}:{jpg:"avif",jpeg:"avif",png:"avif"},ie=0===Object.keys(ae).length?void 0:new RegExp("\\.(".concat(Object.keys(ae).join("|"),")$"),"i"),oe=function(e,t){return new Promise((function(r,n){var a=!1,i=function(e){a||(a=!0,n(e))};return t.onabort=function(e){i(e)},e().then((function(e){return t=e,void(a||(a=!0,r(t)));var t})).catch((function(e){return i(e)}))}))},se=function(){function e(){u(this,e),h(this,"handler",void 0),h(this,"isAborted",!1)}return l(e,[{key:"onabort",get:function(){return this.handler},set:function(e){var t=this;this.handler=e?function(r){t.isAborted||(t.isAborted=!0,e(r))}:void 0}},{key:"aborted",get:function(){return this.isAborted}}]),e}(),ue=function(){function e(){u(this,e),h(this,"signal",new se)}return l(e,[{key:"abort",value:function(e){this.signal.onabort&&this.signal.onabort({type:"abort",target:this,currentTarget:this,timeStamp:Date.now(),data:e})}}]),e}(),ce=function(e){if("function"==typeof self.AbortController){var t=new self.AbortController,r=t.signal;return Object.defineProperty(e,"signal",{get:function(){return r}}),{response:fetch(e),abort:function(){return t.abort()},onAbort:function(e){r.onabort=e}}}var n,a,i=!1;return{response:new Promise((function(t,r){n=r,fetch(e).then((function(e){i||(i=!0,t(e))})).catch((function(e){i||(i=!0,r(e))}))})),abort:function(){var e,t;i||(i=!0,null===(e=n)||void 0===e||e(),null===(t=a)||void 0===t||t())},onAbort:function(e){a=e}}},le="".concat(ee,"-availability"),he=function(){function e(){u(this,e)}var t,r,n,a;return l(e,null,[{key:"enable",value:(a=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isEnabledInMemoryCache=!0,e.abrupt("return",this.cache.then((function(e){return e.put(self.origin,new Response("true"))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"disable",value:(n=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isEnabledInMemoryCache=!1,e.abrupt("return",this.cache.then((function(e){return e.put(self.origin,new Response("false"))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"isEnabled",value:(r=s(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.isEnabledInMemoryCache){e.next=11;break}return e.next=3,this.cache;case 3:return i=e.sent,e.next=6,i.match(self.origin);case 6:return o=e.sent,e.next=9,null!==(t=null==o||null===(r=o.clone)||void 0===r||null===(n=(a=r.call(o)).json)||void 0===n?void 0:n.call(a))&&void 0!==t?t:Promise.resolve(null);case 9:null==(s=e.sent)?this.enable():this.isEnabledInMemoryCache=s;case 11:return e.abrupt("return",this.isEnabledInMemoryCache);case 12:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"isDisabled",value:(t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isEnabled().then((function(e){return!e})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();h(he,"isEnabledInMemoryCache",null),h(he,"cache",caches.open(le));var pe="info",fe="warn",de="error",ve="none",me="default",ge="debug",ye=function(){function e(){u(this,e),h(this,"logLevel",ve)}return l(e,[{key:"log",value:function(){var e;this.canOutputLog("log")&&(e=self.console).log.apply(e,arguments)}},{key:"info",value:function(){var e;this.canOutputLog(pe)&&(e=self.console).info.apply(e,arguments)}},{key:"warn",value:function(){var e;this.canOutputLog(fe)&&(e=self.console).warn.apply(e,arguments)}},{key:"error",value:function(){var e;this.canOutputLog(de)&&(e=self.console).error.apply(e,arguments)}},{key:"debug",value:function(){var e;this.canOutputLog(ge)&&(e=self.console).debug.apply(e,arguments)}},{key:"setLogLevel",value:function(e){this.logLevel=e}},{key:"canOutputLog",value:function(e){switch(this.logLevel){case pe:return["error","warn","info"].includes(e);case fe:return["error","warn"].includes(e);case de:return"error"===e;case ve:return!1;case me:return e!==ge;default:return!0}}}],[{key:"create",value:function(t){if(!this.instances[t]){var r=new e;this.instances[t]=r}return this.instances[t]}},{key:"setLogLevel",value:function(t,r){e.create(t).setLogLevel(r)}}]),e}();h(ye,"instances",{});var be=function(){function e(t){u(this,e),h(this,"cachePromise",void 0),this.cachePromise=t}var t,r,n,a,i;return l(e,[{key:"put",value:(i=s(regeneratorRuntime.mark((function e(t,r){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runCacheOperationWithinTimeLimit(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.cachePromise.then((function(e){return e.put(t,r)})));case 1:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"match",value:(a=s(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runCacheOperationWithinTimeLimit(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.cachePromise.then((function(e){return e.match(t)})));case 1:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"delete",value:(n=s(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runCacheOperationWithinTimeLimit(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.cachePromise.then((function(e){return e.delete(t)})));case 1:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"keys",value:(r=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runCacheOperationWithinTimeLimit(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.cachePromise.then((function(e){return e.keys()})));case 1:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"runCacheOperationWithinTimeLimit",value:(t=s(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new ue,setTimeout((function(){r.abort()}),1e3),e.abrupt("return",oe(t,r.signal));case 3:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}(),ke=ye.create("precacher.caches"),xe=function(){function e(t){u(this,e),h(this,"name",void 0),h(this,"cache",null),h(this,"cacheHitMap",Object.create(null)),this.name=t,e.allCacheMap[this.name]=this}var t,r,n,a,i,o,c,p,f;return l(e,[{key:"get",value:(f=s(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cacheHitMap[t]){e.next=2;break}return e.abrupt("return",this.cacheHitMap[t].clone());case 2:return e.next=4,this.initLazily();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.next=8,this.cache.match(t);case 8:if(!(r=e.sent)){e.next=12;break}return this.cacheHitMap[t]=r.clone(),e.abrupt("return",this.cacheHitMap[t].clone());case 12:return e.abrupt("return",void 0);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getInternalCacheStorage",value:(p=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initLazily();case 2:if(e.sent){e.next=4;break}return e.abrupt("return",null);case 4:return e.abrupt("return",this.cache);case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"put",value:(c=s(regeneratorRuntime.mark((function t(r,n){var a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.cacheHitMap[r]=n,t.abrupt("return",e.globalAsyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.initLazily();case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,a.cache.put(r,n.clone());case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])}))),this.name));case 2:case"end":return t.stop()}}),t,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"delete",value:(o=s(regeneratorRuntime.mark((function t(r){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete this.cacheHitMap[r],t.abrupt("return",e.globalAsyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.initLazily();case 2:if(e.sent){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",n.cache.delete(r));case 5:case"end":return e.stop()}}),e)}))),this.name));case 2:case"end":return t.stop()}}),t,this)}))),function(e){return o.apply(this,arguments)})},{key:"getMemoryCaches",value:function(){return this.cacheHitMap}},{key:"cacheStorageKeys",value:(i=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initLazily();case 2:if(e.sent){e.next=4;break}return e.abrupt("return",[]);case 4:return e.abrupt("return",this.cache.keys());case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"close",value:(a=s(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ke.log("close ".concat(this.name," cache")),t.next=3,e.globalAsyncQueue.discardPendingJob(this.name);case 3:return t.next=5,caches.delete(this.name);case 5:this.cacheHitMap=Object.create(null),this.cache=null;case 7:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"initLazily",value:(n=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cache){e.next=10;break}return ke.log("".concat(this.name," is not initialized")),e.next=4,he.isDisabled();case 4:if(!e.sent){e.next=7;break}return ke.log("cache is disabled"),e.abrupt("return",!1);case 7:return ke.log("initializing ".concat(this.name," succeeded")),this.cache=new be(caches.open(this.name)),e.abrupt("return",!0);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],[{key:"unlockAllStorageAction",value:function(){this.isGloballyLocked=!1,e.globalAsyncQueue.drain()}},{key:"lockAllStorageAction",value:(r=s(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.lockAsyncQueue(s(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.globalAsyncQueue.lockAfterAllProcessingExit();case 3:return e.next=5,t();case 5:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,r.unlockAllStorageAction(),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,,7,10]])})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"close",value:(t=s(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.allCacheMap[r])){t.next=4;break}return t.next=4,n.close();case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]),e}();h(xe,"lockAsyncQueue",E()),h(xe,"isGloballyLocked",!1),h(xe,"globalAsyncQueue",M({lock:function(){xe.isGloballyLocked=!0},unlock:function(){xe.isGloballyLocked=!1},isLocked:function(){return xe.isGloballyLocked}},!1)),h(xe,"allCacheMap",{});var we="".concat(ee,"-config"),Re=new xe(we),Ce="".concat(ee,"-opaque"),Se=new xe(Ce),Pe="".concat(ee,"-cache-serialization-"),Me="".concat(ee,"-m");new xe(Me);var Ee="".concat(ee,"-trf");new xe(Ee);var Oe,Ae=function(){return Re.get(U).then(function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,t.json();case 3:e.t1=e.sent,e.t0={isFound:!0,config:e.t1},e.next=8;break;case 7:e.t0={isFound:!1,config:j};case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){return{isFound:!1,config:j}}))},Le=function(){var e=s(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.get($);case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",t.json());case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ze=function(e,t,r){return new xe(function(e,t,r){return"".concat(ee,"-").concat(e,"-entity-").concat(t,"-").concat(r)}(e,t,r))},Ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return e.priority-t.priority};u(this,e),h(this,"comparator",void 0),h(this,"tree",[]),this.comparator=t}return l(e,[{key:"push",value:function(e){var t=e.value,r=e.priority;this.tree.push({value:t,priority:r}),1!==this.tree.length&&function(e,t){for(var r=e.length-1,n=r,a=e[r];r>=0&&(e[r=r-1>>1]?t(e[r],a):0)<0;){var i=e[r];e[r]=a,e[n]=i,n=r}}(this.tree,this.comparator)}},{key:"pop",value:function(){var e=this.tree[0],t=this.tree.pop();return t&&(this.tree[0]=t,function(e,t){for(var r=0,n=r,a=e[r];r<e.length;){var i=1+(r<<1),o=2+(r<<1),s=i,u=e[i]?t(e[i],a):0,c=e[o]?t(e[o],a):0;if(u>0)s=i;else{if(!(c>0))break;s=o}var l=e[s];e[s]=a,e[n]=l,n=r,r=s}}(this.tree,this.comparator)),e?e.value:void 0}},{key:"peek",value:function(){return this.tree[0]?this.tree[0].value:void 0}},{key:"length",get:function(){return this.tree.length}}]),e}(),_e=l((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;u(this,e),h(this,"key",void 0),h(this,"sizeHint",void 0),h(this,"data",void 0),h(this,"next",""),h(this,"prev",""),this.key=t,this.sizeHint=r,this.data=n}));!function(e){e[e.LENGTH=1]="LENGTH",e[e.SIZE=2]="SIZE"}(Oe||(Oe={}));var Te=function(){function e(){u(this,e),h(this,"entryMap",{})}var t,r,n,a,i;return l(e,[{key:"restore",value:(i=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"onUpdate",value:(a=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"get",value:(n=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.entryMap[t]);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"set",value:(r=s(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.entryMap[t]=r;case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"delete",value:(t=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.entryMap[t];case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),qe=function(){var e=s(regeneratorRuntime.mark((function e(t,r,n,a){var i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.next,o=t.prev,i&&(s=r[i])&&(s.prev=o),o&&(u=r[o])&&(u.next=i),delete r[t.key],!a){e.next=6;break}return e.abrupt("return",n.delete(t.key));case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),je=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Te,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";u(this,e),h(this,"limit",void 0),h(this,"cacheStorageHost",void 0),h(this,"name",void 0),h(this,"id",void 0),h(this,"length",0),h(this,"size",0),h(this,"cacheMetadata",Object.create(null)),h(this,"mru",void 0),h(this,"lru",void 0),h(this,"deleteHandlers",[]),h(this,"restorePromise",void 0),h(this,"asyncQueue",E()),this.limit=t,this.cacheStorageHost=r,this.name=n,this.id=a,this.restorePromise=this.cacheStorageHost.restore(this)}var t,r,n,a,i,o,c,f,d,v,m,g,y,b,k;return l(e,[{key:"updateLimit",value:(k=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.limit=t,e.next=3,this.cacheStorageHost.onUpdate(this);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"getLimit",value:function(){return this.limit}},{key:"put",value:(b=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,u=this,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,n=t.value,a=t.sizeHint,i=t.data,o=c.length>1&&void 0!==c[1]&&c[1],e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){var t,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.restorePromise;case 2:return e.next=4,u.recoveryLruIntegrityIfNecessary();case 4:if(u.lru){e.next=15;break}if(u.lru=new _e(r,a,i),u.mru=u.lru,u.cacheMetadata[r]=u.lru,u.length=1,u.size=u.mru.sizeHint,null==n){e.next=13;break}return e.next=13,u.cacheStorageHost.set(r,n);case 13:case 20:e.next=32;break;case 15:if(!u.mru){e.next=32;break}if(!(t=u.cacheMetadata[r])){e.next=22;break}return e.next=20,u.touch(t);case 22:if(s=new _e(r,a,i),u.mru.next=s.key,s.prev=u.mru.key,u.cacheMetadata[s.key]=s,u.mru=s,u.length++,u.size+=s.sizeHint,null==n){e.next=32;break}return e.next=32,u.cacheStorageHost.set(r,n);case 32:return c=[],e.next=35,u.shrink({shouldIgnoreEvent:o,popedEntryList:c});case 35:return e.next=37,u.updateSerializedData();case 37:return e.abrupt("return",c);case 38:case"end":return e.stop()}}),e)})))));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"delete",value:(y=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,u=this,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:{},n=r.shouldIgnoreEvent,a=void 0!==n&&n,i=r.shouldDeleteFromHost,o=void 0===i||i,e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.restorePromise;case 2:if(u.length){e.next=4;break}return e.abrupt("return",!1);case 4:return e.next=6,u.recoveryLruIntegrityIfNecessary();case 6:if(r=u.cacheMetadata[t],!(u.lru&&u.mru&&r)){e.next=23;break}if(n=o,a){e.next=14;break}return e.next=12,Promise.all(u.deleteHandlers.map((function(e){return e(r)})));case 12:if(!e.sent.some((function(e){return!1===e}))){e.next=14;break}n=!1;case 14:return u.lru.key===r.key?u.lru=u.cacheMetadata[r.next]:u.mru.key===r.key&&(u.mru=u.cacheMetadata[r.prev]),u.length--,u.size-=r.sizeHint,1===u.length?u.mru=u.lru:0===u.length&&(u.mru=void 0,u.lru=void 0,u.size=0),e.next=20,qe(r,u.cacheMetadata,u.cacheStorageHost,n);case 20:return e.next=22,u.updateSerializedData();case 22:return e.abrupt("return",!0);case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"pop",value:(g=s(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o=this,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.shouldIgnoreEvent,n=void 0!==r&&r,a=t.shouldDeleteFromHost,i=void 0===a||a,e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.restorePromise;case 2:return e.abrupt("return",o.popLruEntry({shouldIgnoreEvent:n,shouldDeleteFromHost:i}));case 3:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"estimate",value:function(e){if(this.limit.type===Oe.SIZE&&this.limit.value<e)return{entries:[],isAcceptable:!1};var t=this.size,r=this.length;this.size+=e,this.length++;for(var n=[],a=this.lru;a&&this.isSizeExceeded();)this.size-=a.sizeHint,this.length--,n.push(a),a=this.cacheMetadata[a.next];return this.size=t,this.length=r,{entries:n,isAcceptable:!0}}},{key:"get",value:(m=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getEntry(t).then((function(e){return e?e.value:void 0})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"getEntry",value:(v=s(regeneratorRuntime.mark((function e(t){var r,n,a,i=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},n=r.isMetadataOnly,a=void 0!==n&&n,e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.restorePromise;case 2:if(!a){e.next=5;break}return r=i.cacheMetadata[t],e.abrupt("return",r?{entry:r,value:void 0}:void 0);case 5:return e.next=7,i.verifyCache({key:t,mustReturnValidEntry:!1});case 7:if(!(n=e.sent)){e.next=15;break}if(!n.entry){e.next=12;break}return e.next=12,i.touch(n.entry);case 12:if(n.value){e.next=14;break}return e.abrupt("return",void 0);case 14:return e.abrupt("return",{entry:n.entry,value:n.value});case 15:return e.abrupt("return",void 0);case 16:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"keys",value:(d=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.restorePromise;case 2:return e.abrupt("return",Object.keys(t.cacheMetadata));case 3:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"entries",value:(f=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.restorePromise;case 2:return e.abrupt("return",Object.keys(t.cacheMetadata).map((function(e){return t.cacheMetadata[e]})));case 3:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"lookupMetadata",value:function(e){return this.cacheMetadata[e]}},{key:"lookupCache",value:(c=s(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.verifyCache({key:t,mustReturnValidEntry:!1});case 2:if(!(r=e.sent)){e.next=5;break}return e.abrupt("return",r.value);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"addOnDeleteHandler",value:function(e){this.deleteHandlers.push(e)}},{key:"restore",value:function(e){p(this,e)}},{key:"toJSON",value:function(){return{size:this.size,length:this.length,limit:this.limit,cacheMetadata:this.cacheMetadata,mru:this.mru?this.mru:void 0,lru:this.lru?this.lru:void 0,name:this.name}}},{key:"popLruEntry",value:(o=s(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o,s,u,c,l,h,p=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]?p[0]:{},r=t.shouldIgnoreEvent,n=void 0!==r&&r,a=t.shouldDeleteFromHost,i=void 0===a||a,this.length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.recoveryLruIntegrityIfNecessary();case 5:if(this.lru&&this.mru){e.next=7;break}return e.abrupt("return");case 7:if(this.length--,this.size-=this.lru.sizeHint,o=this.lru,s=this.lru,u=s.next,c=s.key,(l=this.cacheMetadata[u])&&(this.lru=l,this.lru.prev=""),delete this.cacheMetadata[o.key],1===this.length?(this.mru=this.lru,this.mru.next="",this.mru.prev=""):this.length||(this.size=0,this.lru=void 0,this.mru=void 0),h=i,n){e.next=21;break}return e.next=19,Promise.all(this.deleteHandlers.map((function(e){return e(o)})));case 19:if(!e.sent.some((function(e){return!1===e}))){e.next=21;break}h=!1;case 21:if(!h){e.next=24;break}return e.next=24,this.cacheStorageHost.delete(c);case 24:return e.next=26,this.updateSerializedData();case 26:return e.abrupt("return",o);case 27:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"touch",value:(i=s(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mru||this.mru.key!==t.key){e.next=2;break}return e.abrupt("return");case 2:if(this.mru){e.next=5;break}return this.mru=t,e.abrupt("return");case 5:if(this.lru){e.next=8;break}return this.lru=t,e.abrupt("return");case 8:return r=t.next,qe(t,this.cacheMetadata,this.cacheStorageHost,!1),t.key===this.lru.key&&r&&(this.lru=this.cacheMetadata[r]),this.mru.next=t.key,t.next="",t.prev=this.mru.key,this.mru=t,this.cacheMetadata[t.key]=t,e.next=18,this.updateSerializedData();case 18:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"shrink",value:(a=s(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},r=t.shouldIgnoreEvent,n=void 0===r||r,a=t.popedEntryList,!this.isSizeExceeded()){e.next=7;break}return e.next=4,this.popLruEntry({shouldIgnoreEvent:n});case 4:return(i=e.sent)&&a&&a.push(i),e.abrupt("return",this.shrink({shouldIgnoreEvent:n}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"verifyCache",value:(n=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.key,n=t.mustReturnValidEntry,!(a=this.cacheMetadata[r])){e.next=19;break}return e.next=5,this.cacheStorageHost.get(r);case 5:if(i=e.sent){e.next=18;break}return this.lru&&this.lru.key===a.key&&(this.lru=this.cacheMetadata[a.next]),this.mru&&this.mru.key===a.key&&(this.mru=this.cacheMetadata[a.prev]),e.next=11,qe(a,this.cacheMetadata,this.cacheStorageHost,!1);case 11:return this.size-=a.sizeHint,this.length--,0===this.length&&this.reset(),e.next=16,this.verifyCache({key:a.next,mustReturnValidEntry:n});case 16:return o=e.sent,e.abrupt("return",n?o:void 0);case 18:return e.abrupt("return",{value:i,entry:a});case 19:return e.next=21,this.cacheStorageHost.delete(r);case 21:return e.abrupt("return",void 0);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"verifyIntegrity",value:function(){var e={},t=0,r=0;if(this.lru){var n=this.lru;for(t=n.sizeHint,r=1;n!==this.mru;){if(e[n.key])return!1;if(e[n.key]=!0,!n.next)break;var a=this.cacheMetadata[n.next];if(!a)return!1;t+=(n=a).sizeHint,r++}}return this.length?!!this.lru&&!!this.mru&&t===this.size&&r===this.length:(this.reset(),!0)}},{key:"reset",value:function(){p(this,{lru:void 0,mru:void 0,cacheMetadata:Object.create(null),size:0,length:0})}},{key:"isSizeExceeded",value:function(){return(this.limit.type===Oe.LENGTH?this.length:this.size)>this.limit.value}},{key:"updateSerializedData",value:(r=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.verifyIntegrity()){e.next=3;break}return e.next=3,this.cacheStorageHost.onUpdate(this);case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"recoveryLruIntegrityIfNecessary",value:(t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.length||this.lru&&this.mru){e.next=4;break}return e.next=3,this.cacheStorageHost.restore(this);case 3:this.lru&&this.mru&&this.verifyIntegrity()||this.reset();case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Ne=function(){function e(t,r){var n=t.type,a=t.value;u(this,e),h(this,"asyncQueue",E()),h(this,"probationSegment",void 0),h(this,"protectedSegment",void 0),this.probationSegment=new je({type:n,value:.8*a},r,"probation"),this.protectedSegment=new je({type:n,value:.2*a},r,"protected")}var t,r,n,a;return l(e,[{key:"size",get:function(){return this.probationSegment.size+this.protectedSegment.size}},{key:"put",value:(a=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,n=t.value,a=t.sizeHint,i=t.data,e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.protectedSegment.lookupMetadata(r)||o.probationSegment.lookupMetadata(r)){e.next=3;break}return e.next=3,o.probationSegment.put({key:r,value:n,sizeHint:a,data:i});case 3:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"get",value:(n=s(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=r.probationSegment.lookupMetadata(t))){e.next=11;break}return e.next=4,r.probationSegment.get(t);case 4:if(!(a=e.sent)){e.next=10;break}return e.next=8,r.probationSegment.delete(t,{shouldDeleteFromHost:!1});case 8:return e.next=10,r.protectedSegment.put(n);case 10:return e.abrupt("return",a);case 11:return e.abrupt("return",r.protectedSegment.get(t));case 12:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"delete",value:(r=s(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.probationSegment.delete(t);case 2:if(e.sent){e.next=5;break}return e.next=5,r.protectedSegment.delete(t);case 5:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"estimate",value:function(e,t){if(this.protectedSegment.lookupMetadata(e))return{isAcceptable:!1,entries:[]};var r=this.probationSegment.lookupMetadata(e);return r?this.protectedSegment.estimate(r.sizeHint):this.probationSegment.estimate(t)}},{key:"entries",value:(t=s(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.probationSegment.entries();case 2:return t=e.sent,e.next=5,this.protectedSegment.entries();case 5:return r=e.sent,e.abrupt("return",t.concat(r));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"lookupMetadata",value:function(e){return this.lookupProbationMetadata(e)||this.lookupProtectedMetadata(e)}},{key:"lookupProbationMetadata",value:function(e){return this.probationSegment.lookupMetadata(e)}},{key:"lookupProtectedMetadata",value:function(e){return this.protectedSegment.lookupMetadata(e)}},{key:"toJSON",value:function(){return{probationSegment:this.probationSegment.toJSON(),protectedSegment:this.protectedSegment.toJSON()}}}]),e}(),Be=2147483647,He=10000000007,Ue=[3432918353,461845907,3276165377,4246287263],De=function(e){for(var t=Ue[0],r=0;r<e.length;r++)t*=Ue[1],t^=e.charCodeAt(r);return 0|t},Fe=function(e,t,r){var n=(e+Ue[t])%He*Ue[t]%He;return(n+=n>>>16)&r},We=function(e){return 1<<-Math.clz32(e-1)},Ge=function(){function e(t){u(this,e),h(this,"specifiedCapacity",void 0),h(this,"table",void 0),h(this,"tableMask",0),h(this,"size",0),h(this,"capacity",0),h(this,"cachedHash",Object.create(null)),this.specifiedCapacity=t,this.capacity=Math.min(this.specifiedCapacity,Be)>>3,this.table=new Uint8Array(0===this.capacity?1:We(this.capacity)),this.tableMask=Math.max(1,this.table.length-1)}return l(e,[{key:"byteLength",value:function(){return this.table.byteLength}},{key:"mightContains",value:function(e){var t=this.cachedHash[e]||De(e);this.cachedHash[e]=t;var r=1+(1+(7&t)>>>1),n=Fe(t,0,this.tableMask);if(0==(this.table[n]&r))return!1;var a=Fe(t,1,this.tableMask);if(0==(this.table[a]&r<<1))return!1;var i=Fe(t,2,this.tableMask);if(0==(this.table[i]&r<<2))return!1;var o=Fe(t,3,this.tableMask);return 0!=(this.table[o]&r<<3)}},{key:"put",value:function(e){var t=this.cachedHash[e]||De(e);this.cachedHash[e]=t;var r=1+(1+(7&t)>>>1),n=Fe(t,0,this.tableMask),a=Fe(t,1,this.tableMask),i=Fe(t,2,this.tableMask),o=Fe(t,3,this.tableMask),s=this.putAt(n,r);return s|=this.putAt(a,r<<1),s|=this.putAt(i,r<<2),s|=this.putAt(o,r<<3),this.size+=s,!!s}},{key:"clearAllBits",value:function(){p(this,new e(this.specifiedCapacity))}},{key:"serialize",value:function(){return{table:this.table,metadata:[this.tableMask,this.size,this.capacity,this.specifiedCapacity]}}},{key:"restore",value:function(e){var t=f(e.metadata,4),r=t[0],n=t[1],a=t[2],i=t[3];this.table=e.table,this.tableMask=r,this.size=n,this.capacity=a,this.specifiedCapacity=i}},{key:"probabilities",value:function(){var e=8*this.tableMask,t=this.size;return 1-Math.pow(1-Math.exp(-4*t/e),4)}},{key:"putAt",value:function(e,t){return this.table[e]&t?0:(this.table[e]|=t,1)}}]),e}(),Qe=function(){function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u(this,e),h(this,"specifiedCapacity",void 0),h(this,"willResetIfReachingSampleSize",void 0),h(this,"table",void 0),h(this,"tableMask",0),h(this,"sampleSize",0),h(this,"size",0),h(this,"capacity",0),h(this,"cachedHash",Object.create(null)),this.specifiedCapacity=t,this.willResetIfReachingSampleSize=r,this.capacity=Math.min(t,Be)<<1,this.table=new Uint32Array(0===this.capacity?1:We(this.capacity)),this.sampleSize=0===t?10:10*this.capacity,this.sampleSize<=0&&(this.sampleSize=Number.MAX_SAFE_INTEGER),this.tableMask=Math.max(1,this.table.length-1)}return l(e,[{key:"byteLength",value:function(){return this.table.byteLength}},{key:"mightCount",value:function(e){var t=this.cachedHash[e]||De(e);this.cachedHash[e]=t;for(var r=1+(7&t)>>>1,n=Number.MAX_SAFE_INTEGER,a=0;a<4;a++){var i=Fe(t,a,this.tableMask),o=this.table[i]>>>(r+a<<2)&15;n=Math.min(n,o)}return n!==Number.MAX_SAFE_INTEGER?n:0}},{key:"increment",value:function(e){var t=this.cachedHash[e]||De(e);this.cachedHash[e]=t;var r=1+(7&t)>>>1,n=Fe(t,0,this.tableMask),a=Fe(t,1,this.tableMask),i=Fe(t,2,this.tableMask),o=Fe(t,3,this.tableMask),s=this.incrementAt(n,r);s|=this.incrementAt(a,r+1),s|=this.incrementAt(i,r+2),s|=this.incrementAt(o,r+3),this.size+=s,this.willResetIfReachingSampleSize&&s&&this.size===this.sampleSize&&this.reset()}},{key:"serialize",value:function(){return{table:this.table,metadata:[this.tableMask,this.sampleSize,this.size,this.capacity,this.specifiedCapacity,+this.willResetIfReachingSampleSize]}}},{key:"restore",value:function(e){var t=f(e.metadata,6),r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5];this.table=e.table,this.tableMask=r,this.sampleSize=n,this.size=a,this.capacity=i,this.specifiedCapacity=o,this.willResetIfReachingSampleSize=!!s}},{key:"clearAllBits",value:function(){p(this,new e(this.specifiedCapacity,this.willResetIfReachingSampleSize))}},{key:"probabilities",value:function(){var e=8*this.tableMask,t=this.size;return 1-Math.pow(1-Math.exp(-4*t/e),4)}},{key:"incrementAt",value:function(e,t){var r=t<<2,n=15<<r;return(this.table[e]&n)!==n?(this.table[e]+=1<<r,1):0}},{key:"reset",value:function(){for(var e,t,r=0,n=0;n<this.table.length;n++)r+=(e=286331153&this.table[n],t=void 0,((t=e-(e>>1&3681400539)-(e>>2&1227133513))+(t>>3)&3340530119)%63),this.table[n]=this.table[n]>>>1&2004318071;this.size=(this.size>>>1)-(r>>>2)}}]),e}(),Ke=function(){function e(t){u(this,e),h(this,"doorkeeper",void 0),h(this,"frequencySketch",void 0),this.doorkeeper=new Ge(t),this.frequencySketch=new Qe(t<<2)}return l(e,[{key:"judge",value:function(e,t){var r=this;if(!t.length)return!0;var n=Math.ceil(t.reduce((function(e,t){return e+r.frequency(t)}),0)/(t.length||1));return this.frequency(e)>=n}},{key:"frequency",value:function(e){return this.doorkeeper.mightContains(e.key)?this.frequencySketch.mightCount(e.key)||1:0}},{key:"put",value:function(e){this.doorkeeper.mightContains(e)?this.frequencySketch.increment(e):this.doorkeeper.put(e)}},{key:"restoreDoorkeeper",value:function(e){this.doorkeeper.restore(e)}},{key:"restoreFrequencySketch",value:function(e){this.frequencySketch.restore(e)}},{key:"keepEfficiency",value:function(){return this.doorkeeper.probabilities()<.65&&(this.doorkeeper.clearAllBits(),!0)}},{key:"serialize",value:function(){return{dk:this.doorkeeper.serialize(),fs:this.frequencySketch.serialize()}}},{key:"size",value:function(){return this.doorkeeper.byteLength()+this.frequencySketch.byteLength()}}]),e}(),$e=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.storage.estimate();case 3:return e.sent.usage,e.abrupt("return",s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.storage.estimate());case 1:case"end":return e.stop()}}),e)}))));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({quota:0,usage:0}));case 1:case"end":return e.stop()}}),e)}))));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))(),Xe=function(){var e=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$e.then((function(e){return e()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Je=function(){var e=s(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xe.lockAllStorageAction(s(regeneratorRuntime.mark((function e(){var n,a,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe();case 2:return n=e.sent,a=n.usage,i=void 0===a?0:a,e.next=7,Se.getInternalCacheStorage();case 7:if(!(o=e.sent)){e.next=17;break}return e.prev=9,e.next=12,o.put(t,r);case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(9),e.abrupt("return",0);case 17:return e.next=19,Xe();case 19:return s=e.sent,u=s.usage,c=(void 0===u?0:u)-i,e.abrupt("return",c<=0?4e6:c);case 24:case"end":return e.stop()}}),e,null,[[9,14]])})))));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Ve=function(){var e=s(regeneratorRuntime.mark((function e(t,r){var a,i,o,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:{},e.next=3,Je(t,r);case 3:return i=e.sent,o=new Response("",{headers:n(h({"content-length":"".concat(i),"x-repro-opaque":"1"},te,"".concat(i)),a)}),Object.defineProperty(o,"url",{get:function(){return t.url}}),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Ze=function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Se.delete(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Se.get(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),et=function(){function e(t){u(this,e),h(this,"entityCache",void 0),h(this,"cacheSerializer",void 0),h(this,"isOpaqueCache",void 0),h(this,"onRequestSerialization",void 0),h(this,"shouldDeleteOpaqueEntity",void 0),p(this,t)}var t,r,n,a,i;return l(e,[{key:"restore",value:(i=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cacheSerializer.restoreLruCache({lruCache:t,isMainCache:"window"!==t.name}));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"get",value:(a=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.entityCache.get(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"set",value:(n=s(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.entityCache.put(t,r.clone()));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"delete",value:(r=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.entityCache.delete(t);case 2:if(!this.isOpaqueCache||!this.shouldDeleteOpaqueEntity(t)){e.next=5;break}return e.next=5,Ze(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onUpdate",value:(t=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onRequestSerialization(t);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),tt=function(e){try{return decodeURIComponent(e)}catch(t){return e}};var rt="staging",nt="https://staging-api.reproio.com/v1/internal/web/config",at="87f3bcd940aa4a1a84c2e6bb9b891003",it={exports:{}};!function(e,t){!function(e,t){var r={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function a(e){try{delete window[e]}catch(t){window[e]=void 0}}function i(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}function o(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,s=t.timeout||r.timeout,u=t.jsonpCallback||r.jsonpCallback,c=void 0;return new Promise((function(r,l){var h=t.jsonpCallbackFunction||n(),p=u+"_"+h;window[h]=function(e){r({ok:!0,json:function(){return Promise.resolve(e)}}),c&&clearTimeout(c),i(p),a(h)},o+=-1===o.indexOf("?")?"?":"&";var f=document.createElement("script");f.setAttribute("src",""+o+u+"="+h),t.charset&&f.setAttribute("charset",t.charset),t.nonce&&f.setAttribute("nonce",t.nonce),t.referrerPolicy&&f.setAttribute("referrerPolicy",t.referrerPolicy),f.id=p,document.getElementsByTagName("head")[0].appendChild(f),c=setTimeout((function(){l(new Error("JSONP request to "+e+" timed out")),a(h),i(p),window[h]=function(){a(h)}}),s),f.onerror=function(){l(new Error("JSONP request to "+e+" failed")),a(h),i(p),c&&clearTimeout(c)}}))}t.exports=o}(0,e)}(it);var ot,st=self.fetch?self.fetch:function(e,t){return t=t||{},new Promise((function(r,n){var a=new XMLHttpRequest,i=[],o=[],s={},u=function(){return{ok:2==(a.status/100|0),statusText:a.statusText,status:a.status,url:a.responseURL,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([a.response]))},clone:u,headers:{keys:function(){return i},entries:function(){return o},get:function(e){return s[e.toLowerCase()]},has:function(e){return e.toLowerCase()in s}}}};for(var c in a.open(t.method||"get",e,!0),a.onload=function(){a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,r){i.push(t=t.toLowerCase()),o.push([t,r]),s[t]=s[t]?s[t]+","+r:r})),r(u())},a.onerror=n,a.withCredentials="include"==t.credentials,t.headers)a.setRequestHeader(c,t.headers[c]);a.send(t.body||null)}))};!function(e){var t;!function(e){e[e.BeforeInitialized=0]="BeforeInitialized",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(t||(t={}));var r,a,i,o,s=rt,u=at,c=t.BeforeInitialized,l=[];e.notify=function(e){var h=e.error,p=e.extraPayload,f=e.rollbarOptions,d=void 0===f?{}:f,v=e.samplingRatio,m=e.referrer;if(c!==t.BeforeInitialized){if(c!==t.Disabled&&(null==v||1===(g=1,y=v,b=Math.ceil(g),k=Math.floor(y),Math.floor(Math.random()*(k-b))+b))){var g,y,b,k,x="",w="",C={};if(h instanceof Error){var S=h.stack;void 0!==S&&(C=S.split("\n").reduce((function(e,t,r){return e["stacktrace_".concat(String.fromCharCode(65+r))]=t,e}),{})),x=h.message,w=h.name}else{if("string"!=typeof h)return;x=h}var P={environment:s,language:"javascript",code_version:R,body:{message:{body:x,name:w,stacktrace:C,appId:i,idfv:r,isFirstSession:o,referrer:m,url:self.location.href,userAgent:self.navigator.userAgent,userAnnotation:a,extraPayload:p}}};null!=d.fingerprint&&(P=n(n({},P),d)),null!=v&&(P.body.message.useSampling=!0,P.body.message.samplingRatio=v),st("https://api.rollbar.com/api/1/item/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:u,data:P}),mode:"cors"})}}else l.push({error:h,extraPayload:p,rollbarOptions:d,samplingRatio:v,referrer:m})},e.init=function(n,s){if(!n)return c=t.Disabled,void(l=[]);c=t.Enabled,l.forEach((function(t){e.notify(t)})),s&&(r=s.idfv,a=s.userAnnotation,i=s.appId,o=s.isFirstSession)}}(ot||(ot={}));var ut,ct=/\.([^./]+)$/,lt=!1,ht=function(){function e(t,r,n,a,i){var o=this;u(this,e),h(this,"limit",void 0),h(this,"index",void 0),h(this,"userId",void 0),h(this,"type",void 0),h(this,"cacheSerializer",void 0),h(this,"admissionPolicy",void 0),h(this,"windowCache",void 0),h(this,"mainCache",void 0),h(this,"asyncQueue",E()),h(this,"windowCacheEntityStorage",void 0),h(this,"mainCacheEntityStorage",void 0),h(this,"latestWindowCache",void 0),h(this,"latestMainCacheProbationCache",void 0),h(this,"latestMainCacheProtectedCache",void 0),h(this,"latestAdmissionPolicySerializedData",void 0),h(this,"isOpaqueCache",void 0),this.limit=t,this.index=r,this.userId=n,this.type=a,this.cacheSerializer=i,this.admissionPolicy=new Ke(1e4);var s=t-this.admissionPolicy.size(),c=2===a?"opaque-":1===a?"doc-":"",l=2===a;this.isOpaqueCache=l,this.windowCacheEntityStorage=ze("".concat(c,"w"),this.index,n),this.mainCacheEntityStorage=ze("".concat(c,"m"),this.index,n);var p=function(e){return!o.windowCache.lookupMetadata(e)&&!o.mainCache.lookupMetadata(e)};this.windowCache=new je({type:Oe.SIZE,value:.2*s|0},new et({entityCache:this.windowCacheEntityStorage,cacheSerializer:this.cacheSerializer,isOpaqueCache:l,onRequestSerialization:function(e){o.latestWindowCache=e},shouldDeleteOpaqueEntity:p}),"window"),this.mainCache=new Ne({type:Oe.SIZE,value:.8*s|0},new et({entityCache:this.mainCacheEntityStorage,cacheSerializer:this.cacheSerializer,isOpaqueCache:l,onRequestSerialization:function(e){"probation"===e.name?o.latestMainCacheProbationCache=e:o.latestMainCacheProtectedCache=e},shouldDeleteOpaqueEntity:p}))}var t,r,n,a,i,o,c,p;return l(e,[{key:"serializeLatestCacheData",value:(p=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.cacheSerializer.storeSerializedData({windowCache:t.latestWindowCache,mainCacheProbationCache:t.latestMainCacheProbationCache,mainCacheProtectedCache:t.latestMainCacheProtectedCache,admissionPolicyCache:t.latestAdmissionPolicySerializedData});case 2:t.latestWindowCache=void 0,t.latestMainCacheProbationCache=void 0,t.latestMainCacheProtectedCache=void 0,t.latestAdmissionPolicySerializedData=void 0;case 6:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"size",value:function(){return this.windowCache.size+this.mainCache.size+this.admissionPolicy.size()}},{key:"keepEfficiency",value:(c=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.admissionPolicy.keepEfficiency()&&this.updateLatestAdmissionPolicyCache();case 1:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"contains",value:function(e){return!!this.windowCache.lookupMetadata(e)||!!this.mainCache.lookupMetadata(e)}},{key:"put",value:(o=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,n=t.value,a=t.size,i=t.type,e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.restoreAdmissionPolicy();case 2:if(!(t=o.windowCache.estimate(a)).isAcceptable){e.next=9;break}return e.next=6,t.entries.reduce(function(){var e=s(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(!(n=o.mainCache.estimate(r.key,r.sizeHint)).isAcceptable){e.next=12;break}if(!o.admissionPolicy.judge(r,n.entries)){e.next=12;break}return e.next=7,o.windowCache.lookupCache(r.key);case 7:if(!(a=e.sent)){e.next=12;break}return e.next=11,o.mainCache.put({key:r.key,value:a,sizeHint:r.sizeHint,data:r.data});case 11:o.admissionPolicy.put(r.key);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Promise.resolve());case 6:return e.next=8,o.windowCache.put({key:r,value:n,sizeHint:a,data:{t:i}});case 8:return e.abrupt("return",!0);case 9:if(!o.isOpaqueCache){e.next=12;break}return e.next=12,Ze(r);case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"get",value:(i=s(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.restoreAdmissionPolicy();case 2:if(!r.windowCache.lookupMetadata(t)){e.next=8;break}return e.next=5,r.windowCache.get(t);case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,r.mainCache.get(t);case 10:n=e.sent;case 11:if(!n){e.next=15;break}return r.admissionPolicy.put(t),r.updateLatestAdmissionPolicyCache(),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"delete",value:(a=s(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.restoreAdmissionPolicy();case 2:return e.next=4,Promise.all([r.windowCache.delete(t),r.mainCache.delete(t)]);case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"deleteByCondition",value:(n=s(regeneratorRuntime.mark((function e(t){var r,n,a,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conditions,n=t.clientInfo,a=function(e){var t=e.entry,r=e.condition;switch(r.searchBy){case"type":return w[r.value]===t.data.t;case"ext":try{var a=new URL(t.key);return tt(a.pathname).match(ct)[1]===r.value}catch(e){}return!1;case"currentLocation":return t.key===n.url;case"regexp":return new RegExp(r.value,"i").test(tt(t.key));default:return ot.notify({error:new Error("Unsupported searchBy parameter detected"),extraPayload:{condition:r},referrer:n.url}),!1}},e.next=4,this.asyncQueue(s(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.restoreAdmissionPolicy();case 2:return e.next=4,i.windowCache.entries();case 4:return t=e.sent,e.next=7,i.mainCache.entries();case 7:return n=e.sent,e.abrupt("return",Promise.all([{entries:t,cache:i.windowCacheEntityStorage},{entries:n,cache:i.mainCacheEntityStorage}].flatMap(function(){var e=s(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.entries,o=t.cache,e.abrupt("return",n.map(function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.some((function(e){return a({entry:t,condition:e})}))){e.next=4;break}return i.isOpaqueCache&&Ze(t.key),e.next=4,o.delete(t.key);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 9:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"collectGarbage",value:(r=s(regeneratorRuntime.mark((function e(){var t,r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mainCacheEntityStorage.cacheStorageKeys();case 2:return t=e.sent,e.next=5,this.windowCacheEntityStorage.cacheStorageKeys();case 5:return r=e.sent,e.abrupt("return",Promise.all([{keys:t,storage:this.mainCacheEntityStorage,cache:this.mainCache},{keys:r,storage:this.windowCacheEntityStorage,cache:this.windowCache}].flatMap(function(){var e=s(regeneratorRuntime.mark((function e(t){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.keys,a=t.storage,i=t.cache,e.abrupt("return",r.map(function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.lookupMetadata(t.url)){e.next=5;break}if(!n.isOpaqueCache){e.next=4;break}return e.next=4,Ze(t.url);case 4:return e.abrupt("return",a.delete(t.url));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"restoreAdmissionPolicy",value:(t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lt){e.next=2;break}return e.abrupt("return");case 2:return lt=!0,e.abrupt("return",this.cacheSerializer.restoreAdmissionPolicy({admissionPolicy:this.admissionPolicy}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"updateLatestAdmissionPolicyCache",value:function(){this.latestAdmissionPolicySerializedData=this.admissionPolicy.serialize()}}]),e}(),pt={"application/javascript":"js","text/javascript":"js","text/css":"css","application/css":"css","image/jpeg":"image","image/jpg":"image","image/png":"image","image/gif":"image","image/bmp":"image","image/webp":"image","image/avif":"image","image/svg+xml":"image","image/vnd.microsoft.icon":"image","font/woff":"font","font/ttf":"font","font/otf":"font","application/font-otf":"font","application/font-ttf":"font","application/font-woff":"font","application/font-sfnt":"font","text/html":"document"},ft={js:"js",css:"css",jpeg:"image",jpg:"image",png:"image",gif:"image",bmp:"image",webp:"image",avif:"image",svg:"image",icon:"image",woff:"font",ttf:"font",otf:"font",html:"document",htm:"document",php:"document",asp:"document",aspx:"document",jsp:"document","":"unknown"},dt="unknown",vt=/\?.+/g,mt=function(e){var t=e.pathname.split("."),r=t[t.length-1].replace(vt,"").toLowerCase();return r&&ft[r]||dt},gt=function(e,t){var r=e.headers.get("content-type");if(r){var n=pt[r.split(";")[0].trim().toLowerCase()]||dt;if("unknown"!==n)return n}return e.headers.get("x-repro-cache-type")||mt(t)},yt="x-repro-ec-blob-fs-index",bt="x-repro-ec-blob-fs-metadata",kt="x-repro-ec-blob-dk-metadata",xt="x-repro-ec-wc-metadata",wt="x-repro-ec-mcpb-metadata",Rt="x-repro-ec-mcpt-metadata",Ct=function(){var e=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.admissionPolicyCache,a=t.serializedResponse,!n){e.next=3;break}return e.abrupt("return",{blob:new Blob([n.fs.table.buffer,n.dk.table.buffer]),headers:(i={},h(i,yt,"".concat(n.fs.table.byteLength)),h(i,kt,n.dk.metadata.join(",")),h(i,bt,n.fs.metadata.join(",")),i)});case 3:if(!a){e.next=9;break}return e.next=6,a.blob();case 6:return e.t0=e.sent,e.t1=(h(o={},yt,a.headers.get(yt)),h(o,kt,a.headers.get(kt)),h(o,bt,a.headers.get(bt)),o),e.abrupt("return",{blob:e.t0,headers:e.t1});case 9:return e.abrupt("return",{blob:new Blob([]),headers:(r={},h(r,yt,"-1"),h(r,kt,""),h(r,bt,""),r)});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),St=function(e){var t=e.cache,r=e.serializedResponse,n=e.key;if(t)return h({},n,JSON.stringify(t));if(r){var a=r.headers.get(n);return a?h({},n,a):{}}return{}},Pt=function(){function e(t){u(this,e),h(this,"fastCache",void 0),this.fastCache=t}var t,r,a;return l(e,[{key:"storeSerializedData",value:(a=s(regeneratorRuntime.mark((function e(t){var r,a,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.windowCache,a=t.mainCacheProbationCache,i=t.mainCacheProtectedCache,o=t.admissionPolicyCache,e.next=3,this.fastCache.get(Q);case 3:return s=e.sent,e.next=6,Ct({serializedResponse:s,admissionPolicyCache:o});case 6:return u=e.sent,c=new Response(u.blob,{status:200,headers:n(n(n(n({},u.headers),St({cache:r,serializedResponse:s,key:xt})),St({cache:a,serializedResponse:s,key:wt})),St({cache:i,serializedResponse:s,key:Rt}))}),e.next=10,this.fastCache.put(Q,c);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"restoreAdmissionPolicy",value:(r=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,s,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.admissionPolicy,e.next=3,this.fastCache.get(Q);case 3:if(!(n=e.sent)){e.next=27;break}if(!((a=+n.headers.get(yt))<0)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.blob();case 10:return i=e.sent,o=i.slice(0,a),s=i.slice(a,i.size),e.t0=Uint32Array,e.next=16,o.arrayBuffer();case 16:return e.t1=e.sent,u=new e.t0(e.t1),e.t2=Uint8Array,e.next=21,s.arrayBuffer();case 21:e.t3=e.sent,c=new e.t2(e.t3),l=n.headers.get(bt).split(",").map((function(e){return+e})),h=n.headers.get(kt).split(",").map((function(e){return+e})),r.restoreDoorkeeper({metadata:h,table:c}),r.restoreFrequencySketch({metadata:l,table:u});case 27:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"restoreLruCache",value:(t=s(regeneratorRuntime.mark((function e(t){var r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.lruCache,n=t.isMainCache,e.next=3,this.fastCache.get(Q);case 3:(a=e.sent)&&(i="",(i=n?a.headers.get("probation"===r.name?wt:Rt)||"":a.headers.get(xt)||"")&&r.restore(JSON.parse(i)));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),Mt=function(){function e(t,r,n,a){u(this,e),h(this,"index",void 0),h(this,"type",void 0),h(this,"precacherRootCacheKey",void 0),h(this,"nodeSize",void 0),h(this,"cache",void 0),this.index=t,this.type=r,this.precacherRootCacheKey=n,this.nodeSize=a,this.cache=new ht(this.nodeSize,this.index,this.precacherRootCacheKey,r,new Pt(function(e,t,r){return new xe("".concat(Pe).concat(2===r?"-opaque-":1===r?"-doc-":"").concat(e).concat(t?"-".concat(t,"-"):""))}(this.index,this.precacherRootCacheKey,r)))}var t,r,n,a;return l(e,[{key:"set",value:(a=s(regeneratorRuntime.mark((function e(t,r){var n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.headers.get(te),a=r.headers.get("x-repro-cache-type"),i=w[a]||w[gt(r,new URL(t.url))]||w.unknown,e.abrupt("return",this.cache.put({key:t.url,value:r,size:n?+n:1,type:i}));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"get",value:(n=s(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cache.get(t.url);case 2:if(!(r=e.sent)){e.next=21;break}if(!(+(r.headers.get("x-repro-cache-expiration")||"0")>Date.now())){e.next=15;break}if(!r.headers.get("x-repro-opaque")){e.next=14;break}return e.next=9,Ye(t.url);case 9:if(r=e.sent){e.next=14;break}return e.next=13,this.cache.delete(t.url);case 13:case 21:return e.abrupt("return",void 0);case 14:return e.abrupt("return",{value:[t.clone(),r.clone()]});case 15:return this.cache.keepEfficiency(),e.next=18,this.cache.delete(t.url);case 18:if(!r.headers.get("x-repro-opaque")){e.next=21;break}return e.next=21,Ze(t.url);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"collectMetrics",value:function(){return{size:this.cache.size(),nodeIndex:this.index}}},{key:"collectGarbage",value:(r=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cache.collectGarbage());case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"contains",value:function(e){return this.cache.contains(e)}},{key:"serializeLatestCacheData",value:(t=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cache.serializeLatestCacheData());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"size",value:function(){return this.cache.size()}},{key:"deleteByCondition",value:function(e){var t=e.conditions,r=e.clientInfo;return this.cache.deleteByCondition({conditions:t,clientInfo:r})}}]),e}(),Et=!0,Ot=ye.create("precacher"),At=function(e,t){return t.priority-e.priority},Lt=function(){function e(t){u(this,e),h(this,"precacherRootCacheKey",void 0),h(this,"cacheNodeSizeBasedPriorityQueue",new Ie(At)),h(this,"documentCacheNodeSizeBasedPriorityQueue",new Ie(At)),h(this,"opaqueCacheNodeSizeBasedPriorityQueue",new Ie(At)),h(this,"cacheNodeList",[]),h(this,"documentCacheNodeList",[]),h(this,"opaqueCacheNodeList",[]),h(this,"asyncQueue",E()),this.precacherRootCacheKey=t}var t,r,n,a,i,o,c,p,v,m,y;return l(e,[{key:"getUserId",value:function(){return this.precacherRootCacheKey}},{key:"updateRootKey",value:(y=s(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.precacherRootCacheKey,this.precacherRootCacheKey=r,t.abrupt("return",e.clearAllCaches({shouldDeleteAllMetaData:!1,precacherRootKey:n}));case 3:case"end":return t.stop()}}),t,this)}))),function(e){return y.apply(this,arguments)})},{key:"storeSerializedCache",value:(m=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.cacheNodeList.concat(t.opaqueCacheNodeList).concat(t.documentCacheNodeList).map(function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.serializeLatestCacheData());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"set",value:(v=s(regeneratorRuntime.mark((function e(t,r,n){var a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){var i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.contains(t,n)){e.next=2;break}return e.abrupt("return",!0);case 2:return e.next=4,he.isDisabled();case 4:if(!e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:if(i="document"===gt(r,new URL(t.url)),!(o=n?a.opaqueCacheNodeSizeBasedPriorityQueue.pop():i?a.documentCacheNodeSizeBasedPriorityQueue.pop():a.cacheNodeSizeBasedPriorityQueue.pop())){e.next=14;break}return e.next=11,o.set(t,r);case 11:return s=e.sent,n?a.opaqueCacheNodeSizeBasedPriorityQueue.push({value:o,priority:o.size()}):i?a.documentCacheNodeSizeBasedPriorityQueue.push({value:o,priority:o.size()}):a.cacheNodeSizeBasedPriorityQueue.push({value:o,priority:o.size()}),e.abrupt("return",s);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return v.apply(this,arguments)})},{key:"get",value:(p=s(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=-1,a=r?this.opaqueCacheNodeList:this.cacheNodeList.concat(this.documentCacheNodeList),i=g(a.entries()),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=12;break}if(s=f(o.value,2),u=s[0],!s[1].contains(t.url)){e.next=10;break}return n=u,e.abrupt("break",12);case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:if(-1!==n){e.next=22;break}return e.abrupt("return");case 22:if(!a[n]){e.next=30;break}return e.next=25,a[n].get(t);case 25:if(!(c=e.sent)){e.next=28;break}return e.abrupt("return",c.value);case 28:if(!r){e.next=30;break}return e.abrupt("return",this.get(t,!1));case 30:case"end":return e.stop()}}),e,this,[[3,14,17,20]])}))),function(e,t){return p.apply(this,arguments)})},{key:"collectGarbage",value:(c=s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collectGarbageByType(D,this.cacheNodeList);case 2:return e.next=4,this.collectGarbageByType(F,this.documentCacheNodeList);case 4:return e.next=6,this.collectGarbageByType(W,this.opaqueCacheNodeList);case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"checkObjectState",value:function(t){Et&&(Et=!1,e.SIZE_LIMIT=t.cacheLimit)}},{key:"deleteByCondition",value:(o=s(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conditions,n=t.clientInfo,e.abrupt("return",Promise.all(this.cacheNodeList.concat(this.documentCacheNodeList).map((function(e){return e.deleteByCondition({conditions:r,clientInfo:n})}))));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"contains",value:function(e,t){for(var r=t?this.opaqueCacheNodeList:this.cacheNodeList.concat(this.documentCacheNodeList),n=0;n<r.length;n++)if(r[n].contains(e.url))return!0;return!!t&&this.contains(e,!1)}},{key:"allocateNode",value:(i=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.size,n=t.nodeSize,a=t.type,r){e.next=3;break}return e.abrupt("return");case 3:if(!(r<=n)){e.next=6;break}return this.createShardedCacheNode(0,a,r),e.abrupt("return");case 6:for(o=(r-(i=r%n))/n,s=Math.round(i/o),u=0;u<o;u++)this.createShardedCacheNode(u,a,s+n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createShardedCacheNode",value:(a=s(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new Mt(t,r,this.precacherRootCacheKey,n),e.t0=r,e.next=0===e.t0?4:1===e.t0?7:2===e.t0?10:13;break;case 4:return this.cacheNodeList.push(a),this.cacheNodeSizeBasedPriorityQueue.push({value:a,priority:a.size()}),e.abrupt("break",14);case 7:return this.documentCacheNodeList.push(a),this.documentCacheNodeSizeBasedPriorityQueue.push({value:a,priority:a.size()}),e.abrupt("break",14);case 10:return this.opaqueCacheNodeList.push(a),this.opaqueCacheNodeSizeBasedPriorityQueue.push({value:a,priority:a.size()}),e.abrupt("break",14);case 13:return e.abrupt("break",14);case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return a.apply(this,arguments)})},{key:"collectGarbageByType",value:(n=s(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.get(t);case 2:if(n=e.sent,a=0,!n){e.next=9;break}return e.next=7,n.json();case 7:(a=e.sent)===r.length&&(a=0);case 9:return e.next=11,r[a].collectGarbage();case 11:return e.next=13,Re.put(t,new Response("".concat(a+1)));case 13:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)})}],[{key:"clearAllCaches",value:(r=s(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.shouldDeleteAllMetaData,n=t.precacherRootKey,a=void 0===n?"":n,e.abrupt("return",xe.lockAllStorageAction(s(regeneratorRuntime.mark((function e(){var t,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(Ot.log("Start clear all caches"),t=[],n=Object.keys(xe.allCacheMap),i=0;i<n.length;i++)(o=xe.allCacheMap[n[i]]).name.includes(ee)&&o.name.includes(a)&&(o.name.includes("-entity-")||o.name.includes("-serialization-")||o.name.includes("-opaque"))&&t.push(o.close());return e.next=6,Promise.all([].concat(t,d(r?[xe.close(we),xe.close(Ee)]:[])));case 6:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"new",value:(t=s(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new e(r),t.next=3,n.allocateNode({size:.6*e.SIZE_LIMIT,nodeSize:X,type:0});case 3:return t.next=5,n.allocateNode({size:.4*e.SIZE_LIMIT,nodeSize:X,type:1});case 5:return t.next=7,n.allocateNode({size:e.OPAQUE_SIZE_LIMIT,nodeSize:25e7,type:2});case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})}]),e}();h(Lt,"SIZE_LIMIT",j.cacheLimit),h(Lt,"OPAQUE_SIZE_LIMIT",j.opaqueCacheLimit);var zt,It=E(),_t=function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",It(s(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.configApiRequestParameters.userAnnotation||t.configApiRequestParameters.idfv){e.next=2;break}return e.abrupt("return");case 2:if(r="".concat(t.configApiRequestParameters.idfv,"-").concat(t.configApiRequestParameters.userAnnotation),!ut){e.next=9;break}if(ut.getUserId()===r){e.next=8;break}return ut.updateRootKey(r),e.next=8,Re.put(Y,new Response(JSON.stringify(r)));case 8:return e.abrupt("return",ut);case 9:return e.next=11,Re.get(Y);case 11:return n=e.sent,e.next=14,Re.put(Y,new Response(JSON.stringify(r)));case 14:if(!n){e.next=23;break}return e.next=17,n.json();case 17:if(e.sent===r){e.next=21;break}return e.next=21,Lt.clearAllCaches({shouldDeleteAllMetaData:!1});case 21:e.next=25;break;case 23:return e.next=25,Lt.clearAllCaches({shouldDeleteAllMetaData:!1});case 25:return e.next=27,Lt.new(r);case 27:return ut=e.sent,e.abrupt("return",ut);case 29:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Tt={},qt=function(e){var t=Tt[e];if(t)return t;var r=new RegExp(e,"i");return Tt[e]=r,r},jt=/[{(`]/,Nt=function(e){var t=e.url,r=e.filters,n=e.shouldCheckExcludesOnly,a=e.shouldCheckOnlyUrl,i=function(e){var t=tt(e);return function(e){switch(e.type){case"url":return qt(e.value).test(t);case"dom":if(e.selector){var r=document.querySelector(e.selector);return!(!r||!r.textContent)&&qt(e.value).test(r.textContent)}return!1;case"expr":try{if(jt.test(e.expr))return!1;var n=Function("for (".concat(e.expr," in {});try {return ").concat(e.expr,'.toString()} catch(e) {return ""}'))();return qt(e.value).test(n)}catch(e){return!1}default:return!1}}}(t),o=!0;return n||(o=!!r.includes.length&&r.includes.filter((function(e){return!a||"url"===e.type})).some(i)),o&&r.excludes.filter((function(e){return!a||"url"===e.type})).every((function(e){return!i(e)}))},Bt=function(e){var t=e.url,r=e.method,n=e.mode,a=e.cacheBustingTriggerConfig;if(a.length){var i=tt(t);return a.find((function(e){if(e.isNavigationOnly&&"navigate"!==n)return!1;if("*"!==e.method&&e.method!==r)return!1;switch(e.matchWith){case"ext":var t=i.lastIndexOf("/"),a=i.lastIndexOf(".");return a>t?i.slice(a+1)===e.value:e;case"regexp":return new RegExp(e.value).test(i);default:return e}}))}},Ht=function(){var e=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.response,n=t.onModifyHeaders,a=void 0===n?function(e){return e}:n,i=r.clone(),o=i.blob(),e.next=5,o;case 5:return s=e.sent,u=function(){var e,t={},n=0,a=g(r.headers.entries());try{for(a.s();!(e=a.n()).done;){var i=f(e.value,2),o=i[0],u=i[1];n+=o.length+u.length,t[o]=u}}catch(e){a.e(e)}finally{a.f()}return t["content-length"]||(t["content-length"]="".concat(s.size)),t[te]=r.headers.get(te)||"".concat(n+s.size),t},c=u(),l=a(c),e.abrupt("return",new Response(s,{headers:l,status:i.status,statusText:i.statusText}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=null,Dt=function(){function e(){u(this,e),h(this,"asyncQueue",E()),h(this,"prefetchedCount",-1),h(this,"usedCount",-1),h(this,"timer",0)}var t,r,n;return l(e,[{key:"getReport",value:function(){var e=this;return this.asyncQueue(s(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.restore();case 2:return r={prefetchedCount:e.prefetchedCount,usedCount:e.usedCount},e.prefetchedCount=0,e.usedCount=0,t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)}))))}},{key:"incrementPrefetchedCount",value:(n=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.restore();case 2:t.prefetchedCount+=1,t.requestSerialization();case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"incrementUsedCount",value:(r=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncQueue(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.restore();case 2:t.usedCount+=1,t.requestSerialization();case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"restore",value:(t=s(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.prefetchedCount<0)){e.next=17;break}return e.next=3,Re.get(K);case 3:if(t=e.sent){e.next=8;break}return this.prefetchedCount=0,this.usedCount=0,e.abrupt("return");case 8:return e.next=10,t.json();case 10:if((r=e.sent).prefetchedCount&&r.usedCount){e.next=15;break}return this.prefetchedCount=0,this.usedCount=0,e.abrupt("return");case 15:this.prefetchedCount=r.prefetchedCount,this.usedCount=r.usedCount;case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"requestSerialization",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){Re.put(K,new Response(JSON.stringify({prefetchedCount:e.prefetchedCount,usedCount:e.usedCount})))}),100)}}],[{key:"getInstance",value:function(){return Ut||(Ut=new e),Ut}}]),e}(),Ft=function(){var e=s(regeneratorRuntime.mark((function e(t){var r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now(),e.next=3,Ae();case 3:return a=e.sent,i=a.config,e.abrupt("return",(null!==(r=i.cacheConfig[t])&&void 0!==r?r:z[t])+n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Wt=ye.create("precacher.proxy"),Gt=function(e){var t=e.request,r=e.config,a=function(e){var t=e.proxyHost,r=e.url,n=e.revision;if(!ie)return null;var a=r.pathname.toLocaleLowerCase().match(ie);if(!a)return null;var i=a[1].toLocaleLowerCase(),o=ae[i];if(!o)return null;var s=new URL(r.href);return s.searchParams.sort(),new URL("".concat(t.replace(/\/$/,""),"/").concat(n,"/insecure/plain/").concat(encodeURIComponent(s.href),"@").concat(o))}({proxyHost:e.host,url:e.url,revision:r.proxyConfig.imageProxy.cacheRevision});return a?(Wt.debug(["Rewrite image URL",t.url,a.href,window.location.origin]),Wt.debug("hello logs"),Wt.debug(window.location.origin),new Request(a.href,{headers:n(n({},t.headers),{},{"X-Repro-Original-Url":t.url,"X-Repro-Max-Age":r.cacheConfig.image.toString(),"X-Repro-Origin":window.location.origin}),redirect:"follow",credentials:"omit",mode:"cors"})):t},Qt={},Kt=function(){var e=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ce(t),n=r.response,a=r.abort,i=r.onAbort,Qt[t.url]||(Qt[t.url]=[]),o=new Response("",{status:200,statusText:"ABORTED_BY_PRECACHER"}),Qt[t.url].push((function(e){e&&(o=e),a()})),e.abrupt("return",new Promise((function(e,r){var a=!1,s=function(e){a||(a=!0,e())};n.then((function(t){return s((function(){return e(t)}))})).catch((function(e){return s((function(){return r(e)}))})).finally((function(){return delete Qt[t.url]})),i((function(){return s((function(){return e(o)}))}))})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$t=function(e){var t=e.url,r=e.customResponse;if(Qt[t]){var n,a=g(Qt[t]);try{for(a.s();!(n=a.n()).done;){(0,n.value)(r)}}catch(e){a.e(e)}finally{a.f()}delete Qt[t]}},Xt=function(e){for(var t=0,r=Object.keys(Qt);t<r.length;t++){var n,a=r[t],i=g(Qt[a]);try{for(i.s();!(n=i.n()).done;){(0,n.value)(e)}}catch(e){i.e(e)}finally{i.f()}delete Qt[a]}},Jt=Dt.getInstance(),Vt=function(){function e(){u(this,e),h(this,"lastResponse",void 0),h(this,"timeout",void 0)}var t;return l(e,[{key:"getResponse",value:(t=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.request,this.isMatchedWithUrl(o.url)){e.next=3;break}return e.abrupt("return",Promise.reject(null));case 3:return e.abrupt("return",null!==(r=null===(n=this.lastResponse)||void 0===n||null===(a=n.response)||void 0===a||null===(i=a.then)||void 0===i?void 0:i.call(a,(function(e){var t;return"navigate"===o.mode&&null!==(t=s.lastResponse)&&void 0!==t&&t.isPrefetched&&Jt.incrementUsedCount(),e.clone()})))&&void 0!==r?r:Promise.reject(null));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"clear",value:function(){this.lastResponse=void 0}},{key:"store",value:function(e){var t=this;clearTimeout(this.timeout),this.lastResponse=e,this.timeout=setTimeout((function(){t.clear()}),1e3)}},{key:"isMatchedWithUrl",value:function(e){return!!this.lastResponse&&this.lastResponse.url.href===e}}]),e}(),Zt=function(){function e(){u(this,e),h(this,"caches",new Map),h(this,"timerCache",new Map)}return l(e,[{key:"set",value:function(e){var t=this,r=e.url,n=e.response;this.caches.set(r,n),clearTimeout(this.timerCache.get(r)),this.timerCache.set(r,self.setTimeout((function(){t.caches.delete(r),t.timerCache.delete(r)}),2e3))}},{key:"get",value:function(e){try{return this.caches.get(e)}catch(e){return}finally{this.caches.delete(e),clearTimeout(this.timerCache.get(e)),this.timerCache.delete(e)}}}]),e}(),Yt=function(e){clearTimeout(zt),zt=setTimeout((function(){e.storeSerializedCache()}),500)},er=function(){var e=s(regeneratorRuntime.mark((function e(t){var r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.shardedCache,n=t.request,a=t.response,i=t.isOpaqueRequest,e.next=3,r.set(n,a,i);case 3:if(!e.sent){e.next=7;break}Yt(r),e.next=8;break;case 7:i&&Ze(n.url);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tr=ye.create("precacher.prefetch"),rr=ye.create("precacher.filter"),nr=ye.create("precacher"),ar=function(){function e(t){u(this,e),h(this,"option",void 0),this.option=n(n({},t),{},{request:t.request}),this.option.url.hash=""}var t,r,a,i,o,c,p,f,d,v,m,g,y,b;return l(e,[{key:"fetch",value:(b=s(regeneratorRuntime.mark((function t(){var r,n,a,i,o,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return nr.log("Start ResourceFetcher#fetch",this.option.request),r=this.option,n=r.shardedCache,a=r.config,t.next=4,this.bustingCacheIfNecessary({shardedCache:n,config:a});case 4:if(t.t0=t.sent,t.t0){t.next=9;break}return t.next=8,this.isMatchedWithExclusionFilter({config:a});case 8:t.t0=t.sent;case 9:if(!t.t0){t.next=12;break}return nr.info("This resource is excluded",this.option),t.abrupt("return",Kt(this.option.request));case 12:if("get"===this.option.method){t.next=14;break}return t.abrupt("return",Kt(this.option.request));case 14:if(nr.info("Start searching redirected response",this.option),!(i=e.redirectedLocationResponseTemporaryCaches.get(this.option.url.href))){t.next=19;break}return nr.info("Redirected response found",this.option,i),t.abrupt("return",i);case 19:return nr.info("Start searching cache",this.option),t.next=22,this.searchCache({shardedCache:n});case 22:if(!(o=t.sent)){t.next=27;break}return nr.info("Cache found",this.option,o),this.postback(),t.abrupt("return",this.maybeUseRedirect(o));case 27:return t.abrupt("return",e.complementaryCache.getResponse({request:this.option.request}).then((function(e){return nr.info("Match with ComplementaryCache",s.option,e),s.postback(),e})).catch((function(){nr.info("Caches not found",s.option);var t=s.fetchAndIncrementPrefetchedCount().then((function(e){return s.mightCache({response:e,shardedCache:n,config:a})}));if("document"===s.option.type){var r={url:s.option.url,isPrefetched:s.option.isPrefetch,response:t};nr.info("ComplementaryCache stored with",r),e.complementaryCache.store(r)}return t})));case 28:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"fetchAndIncrementPrefetchedCount",value:(y=s(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nr.log("Start fetching resource",this.option),e.abrupt("return",(this.option.isPrefetch?this.prefetch():this.tryProxyRequest()).then((function(e){return t.option.isPrefetch&&"document"===t.option.type&&200===e.status&&Jt.incrementPrefetchedCount(),e})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"tryProxyRequest",value:(g=s(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={request:this.option.request,config:this.option.config,type:mt(this.option.url),url:this.option.url},a=void 0,i=void 0,o=void 0,u=void 0,c=void 0,a=n.request,i=n.config,o=n.type,u=n.url,!((c=i.proxyConfig.imageProxy).active&&c.hosts.length&&"navigate"!==a.mode&&"image"===o&&Nt({url:u.href,filters:c.filters,shouldCheckExcludesOnly:!1,shouldCheckOnlyUrl:!0}))){e.next=3;break}return t=function(){var e=s(regeneratorRuntime.mark((function e(n){var a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.option.config.proxyConfig.imageProxy,i=Gt({request:r.option.request,config:r.option.config,host:a.hosts[n].host,url:r.option.url}),a.timeout&&setTimeout((function(){$t({url:i.url,customResponse:new Response("",{status:408})})}),a.timeout),o=function(){return a.hosts.length-1>n?t(n+1):Kt(r.option.request)},e.abrupt("return",Kt(i).then((function(e){return e.ok?e:o()})).catch((function(){return o()})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.abrupt("return",t(0));case 3:return e.abrupt("return",Kt(this.option.request));case 4:case"end":return e.stop()}var n,a,i,o,u,c}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"mightCache",value:(m=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,s,u,c,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.shardedCache,n=t.response,a=t.config,i=0===n.status,o=n.redirected&&!!n.url&&this.option.request.url!==n.url,!i){e.next=7;break}e.t0=n.clone(),e.next=10;break;case 7:return e.next=9,this.prepareClone({response:n,isRedirecWithUrlChanging:o});case 9:e.t0=e.sent;case 10:if(s=e.t0,u=i?n:s.clone(),!(i&&!this.option.url.search.length&&a.opaqueCacheLimit>0)){e.next=21;break}return e.t1=Ve,e.t2=this.option.request,e.t3=n,e.next=18,this.prepareHeaders({response:n,shouldUseLocationHeader:!1});case 18:return e.t4=e.sent,(0,e.t1)(e.t2,e.t3,e.t4).then((function(e){return l.putCache({shardedCache:r,response:e,isOpaqueRequest:!0})})),e.abrupt("return",u);case 21:if(200===n.status&&"ABORTED_BY_PRECACHER"!==n.statusText){e.next=23;break}return e.abrupt("return",n);case 23:if(c=this.putCache({shardedCache:r,response:s,isOpaqueRequest:i}),!this.option.isPrefetch){e.next=27;break}return e.next=27,c;case 27:return e.abrupt("return",this.maybeUseRedirect(u));case 28:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"putCache",value:(v=s(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.shardedCache,n=t.response,a=t.isOpaqueRequest,nr.log("Start putting cache",this.option),e.next=4,er({shardedCache:r,response:n,request:this.option.request,isOpaqueRequest:a});case 4:nr.log("End putting cache",this.option);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"prepareClone",value:(d=s(regeneratorRuntime.mark((function e(t){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.response,a=t.isRedirecWithUrlChanging,e.next=3,this.prepareHeaders({response:r,shouldUseLocationHeader:a});case 3:return i=e.sent,e.abrupt("return",Ht({response:r,onModifyHeaders:function(e){return n(n({},i),e)}}));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"prepareHeaders",value:(f=s(regeneratorRuntime.mark((function e(t){var r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.response,a=t.shouldUseLocationHeader,i=this.option.type||gt(r,new URL(this.option.request.url)),e.next=4,Ft(i);case 4:return o=e.sent,e.abrupt("return",n(n({"x-repro-cache-expiration":"".concat(o||0),"x-repro-cache-type":"".concat(i),"x-repro-last-fetched":"".concat(Date.now())},this.option.isPrefetch?{"x-repro-prefetch":"1"}:{}),a?{"x-repro-location":r.url}:{}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"bustingCacheIfNecessary",value:(p=s(regeneratorRuntime.mark((function t(r){var n,a,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.shardedCache,i=r.config,!(o=Bt({url:this.option.url.href,method:this.option.method,mode:this.option.request.mode,cacheBustingTriggerConfig:null!==(n=i.cacheBustingTriggerUrl)&&void 0!==n?n:[]}))){t.next=23;break}if(rr.info("CacheBustingTriggerConfig matched",this.option),this.option.isPrefetch){t.next=21;break}if("all"!==o.cacheDeleteConditions){t.next=11;break}return rr.info("CacheBustingTriggerConfig clear all caches",this.option),t.next=9,Lt.clearAllCaches({shouldDeleteAllMetaData:!0});case 9:t.next=21;break;case 11:return rr.info("CacheBustingTriggerConfig delete by condition",o.cacheDeleteConditions,this.option),t.t0=a,t.t1=o.cacheDeleteConditions,t.next=16,Le();case 16:return t.t2=t.sent,t.t3={url:t.t2},t.t4={conditions:t.t1,clientInfo:t.t3},t.next=21,t.t0.deleteByCondition.call(t.t0,t.t4);case 21:return e.complementaryCache.clear(),t.abrupt("return",!0);case 23:return t.abrupt("return",!1);case 24:case"end":return t.stop()}}),t,this)}))),function(e){return p.apply(this,arguments)})},{key:"isMatchedWithExclusionFilter",value:(c=s(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.config,e.abrupt("return",!this.option.isPrefetch&&!Nt({url:this.option.url.href,filters:r.filter,shouldCheckExcludesOnly:!0,shouldCheckOnlyUrl:!0}));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"searchCache",value:(o=s(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.shardedCache,e.next=3,r.get(this.option.request,!this.option.isPrefetch&&this.option.url.origin!==self.origin);case 3:if(!(n=e.sent)){e.next=9;break}return Yt(r),a=this.option.request,i=n[1],"navigate"===a.mode&&i.headers.has("x-repro-prefetch")&&Jt.incrementUsedCount(),nr.info("Cache found",this.option.url.href,n,this.option),e.abrupt("return",n[1]);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}var a,i}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"postback",value:function(){"navigate"===this.option.request.mode&&(nr.info("Start postback",this.option.url.href,this.option),function(e){var t=e.config,r=e.url;if(t.active&&Nt({url:r.href,filters:t.filters,shouldCheckExcludesOnly:!1,shouldCheckOnlyUrl:!0})){var a=new URL(r.href);t.addQueryParamToPostback&&a.searchParams.append("rpr_postback","1");var i=new Request(a.href,{headers:n(n({},re),t.addHeaderToPostback?{"x-repro-postback":"1"}:{})});Kt(i)}}({config:this.option.config.prefetchPostback,url:this.option.url}))}},{key:"prefetch",value:(i=s(regeneratorRuntime.mark((function e(){var t,r,n,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.option.request,this.option.config.addQueryParamToPrefetch&&"document"===this.option.type&&((r=new URL(this.option.url)).searchParams.append(ne,"1"),t=new Request(r.href,this.option.request)),n=ce(t),a=n.response,i=n.abort,o=setTimeout((function(){i()}),1e4),e.abrupt("return",a.then((function(e){var t=new URL(e.url);return t.searchParams.delete(ne),Object.defineProperty(e,"url",{value:t.href}),e})).finally((function(){return clearTimeout(o)})));case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"maybeUseRedirect",value:function(t){var r=t.headers.get("x-repro-location");return r&&!this.option.isPrefetch&&e.redirectedLocationResponseTemporaryCaches.set({url:r,response:t}),r?new Response("",{headers:{location:r},status:302}):t}}],[{key:"fetch",value:(a=s(regeneratorRuntime.mark((function t(r){var n,a,i,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.request,a=new URL(n.url),t.next=4,this.prepareResourceFetching();case 4:if(i=t.sent){t.next=7;break}return t.abrupt("return",Kt(n));case 7:return o=i.shardedCache,s=i.config,"navigate"===n.mode&&a.origin===self.origin&&(Re.put($,new Response(JSON.stringify(n.url))),Xt()),t.abrupt("return",new e({isPrefetch:!1,url:a,request:n,method:n.method.toLowerCase(),shardedCache:o,config:s}).fetch());case 10:case"end":return t.stop()}}),t,this)}))),function(e){return a.apply(this,arguments)})},{key:"prefetch",value:(r=s(regeneratorRuntime.mark((function t(r){var a,i,o,s,u,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.url,i=r.type,o=r.referrer,tr.info("Start prefetching",a,i),t.next=4,this.prepareResourceFetching();case 4:if(s=t.sent){t.next=7;break}return t.abrupt("return");case 7:return u=s.shardedCache,c=s.config,l=new Request(a.href,{method:"get",referrer:o,headers:n(n({},re),c.addHeaderToPrefetch&&"document"===i?{"x-rpr-prefetch":"1"}:{})}),t.next=11,new e({isPrefetch:!0,url:a,request:l,method:l.method.toLowerCase(),type:i,shardedCache:u,config:c}).fetch();case 11:case"end":return t.stop()}}),t,this)}))),function(e){return r.apply(this,arguments)})},{key:"prepareResourceFetching",value:(t=s(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae();case 2:if(t=e.sent,r=t.isFound,n=t.config,r){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=9,_t(n);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return",null);case 12:return a.checkObjectState(n),e.abrupt("return",{shardedCache:a,config:n});case 14:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}();h(ar,"complementaryCache",new Vt),h(ar,"redirectedLocationResponseTemporaryCaches",new Zt);var ir,or=function(){function t(e){u(this,t),h(this,"ports",void 0),p(this,e)}var r,n,a,o,c,f,v,m,g,y,b;return l(t,[{key:"handleInitEvent",value:(b=s(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.config,(n=t.version)===C){e.next=5;break}return he.disable(),this.ports[0].postMessage({type:"VERSION_MISMATCHED",fromVersion:(a={fromVersion:C,toVersion:n}).fromVersion,toVersion:a.toVersion}),e.abrupt("return");case 5:return Lt.SIZE_LIMIT=r.cacheLimit,Lt.OPAQUE_SIZE_LIMIT=r.opaqueCacheLimit,ot.init(!0,r.configApiRequestParameters),e.next=10,Re.put(U,new Response(JSON.stringify(r),{status:200}));case 10:he.enable(),this.ports[0].postMessage({});case 12:case"end":return e.stop()}var a}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"handleFetchEvent",value:(y=s(regeneratorRuntime.mark((function e(t){var r,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.urlList,n=t.clientInfo,e.abrupt("return",Promise.all(r.map(function(){var e=s(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,a=t.type,new URL(r).origin===self.origin){e.next=4;break}return e.abrupt("return");case 4:return e.abrupt("return",ar.prefetch({url:new URL(r),type:a,referrer:n.url}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(){a.ports[0].postMessage({})})));case 2:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"handleUserAnnotationEvent",value:(g=s(regeneratorRuntime.mark((function e(t){var r,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lt.clearAllCaches({shouldDeleteAllMetaData:!0});case 2:return r=t.userAnnotation,e.next=5,Ae();case 5:if(n=e.sent,a=n.isFound,i=n.config,!a){e.next=12;break}return i.configApiRequestParameters.userAnnotation=r,e.next=12,Re.put(U,new Response(JSON.stringify(i),{status:200}));case 12:this.ports[0].postMessage({});case 13:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"handleCollectTrafficReportEvent",value:(m=s(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae();case 2:return r=e.sent,n=r.config,e.next=6,_t(n);case 6:if(!(a=e.sent)){e.next=14;break}return a.checkObjectState(n),e.t0=this.ports[0],e.next=12,Dt.getInstance().getReport();case 12:e.t1=e.sent,e.t0.postMessage.call(e.t0,e.t1);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"handleCollectGarbageEvent",value:(v=s(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae();case 2:return r=e.sent,n=r.config,e.next=6,_t(n);case 6:if(!(a=e.sent)){e.next=12;break}return a.checkObjectState(n),e.next=11,a.collectGarbage();case 11:this.ports[0].postMessage({});case 12:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"handleDeleteByConditionEvent",value:(f=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae();case 2:return r=e.sent,n=r.config,e.next=6,_t(n);case 6:(a=e.sent)&&(i=t.conditions,o=t.clientInfo,a.checkObjectState(n),a.deleteByCondition({conditions:i,clientInfo:o}),this.ports[0].postMessage({}));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"handlePrecacherStopEvent",value:(c=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return he.disable(),e.next=3,Lt.clearAllCaches({shouldDeleteAllMetaData:!0});case 3:this.ports[0].postMessage({});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"handleClearEvent",value:(o=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lt.clearAllCaches({shouldDeleteAllMetaData:!1});case 2:this.ports[0].postMessage({});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"handleMemoryCaches",value:(a=s(regeneratorRuntime.mark((function t(r){var n,a,i,o,s,u,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=r.cacheStorageNameRegexp,a={},i=!1,o=!1,t.prev=4,u=function(){var e=l.value.getMemoryCaches();Object.keys(e).forEach((function(t){a[t]={};var r=a[t];e[t].headers.forEach((function(e,t){r[t]=e}))}))},c=e(this.searchKeysByRegex({cacheStorageNameRegexp:n}));case 7:return t.next=9,c.next();case 9:if(!(i=!(l=t.sent).done)){t.next=14;break}u();case 11:i=!1,t.next=7;break;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(4),o=!0,s=t.t0;case 20:if(t.prev=20,t.prev=21,!i||null==c.return){t.next=25;break}return t.next=25,c.return();case 25:if(t.prev=25,!o){t.next=28;break}throw s;case 28:return t.finish(25);case 29:return t.finish(20);case 30:this.ports[0].postMessage(a);case 31:case"end":return t.stop()}}),t,this,[[4,16,20,30],[21,,25,29]])}))),function(e){return a.apply(this,arguments)})},{key:"handleAllKeys",value:(n=s(regeneratorRuntime.mark((function t(r){var n,a,i,o,s,u,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=r.cacheStorageNameRegexp,a=new Set,i=!1,o=!1,t.prev=4,u=e(this.searchKeysByRegex({cacheStorageNameRegexp:n}));case 6:return t.next=8,u.next();case 8:if(!(i=!(c=t.sent).done)){t.next=17;break}return l=c.value,Object.keys(l.getMemoryCaches()).forEach((function(e){return a.add(e)})),t.next=13,l.cacheStorageKeys();case 13:t.sent.forEach((function(e){return a.add(e.url)}));case 14:i=!1,t.next=6;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(4),o=!0,s=t.t0;case 23:if(t.prev=23,t.prev=24,!i||null==u.return){t.next=28;break}return t.next=28,u.return();case 28:if(t.prev=28,!o){t.next=31;break}throw s;case 31:return t.finish(28);case 32:return t.finish(23);case 33:this.ports[0].postMessage({keys:d(a.keys())});case 34:case"end":return t.stop()}}),t,this,[[4,19,23,33],[24,,28,32]])}))),function(e){return n.apply(this,arguments)})},{key:"searchKeysByRegex",value:function(e){var t,r=e.cacheStorageNameRegexp;return(t=regeneratorRuntime.mark((function e(){var t,n,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new RegExp(r),n=0,a=Object.keys(xe.allCacheMap);case 2:if(!(n<a.length)){e.next=10;break}if(i=a[n],!t.test(i)){e.next=7;break}return e.next=7,xe.allCacheMap[i];case 7:n++,e.next=2;break;case 10:case"end":return e.stop()}}),e)})),function(){return new i(t.apply(this,arguments))})()}}],[{key:"receive",value:(r=s(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new t(r),e.t0=r.data.type,e.next="repro-precacher-init"===e.t0?4:"repro-precacher-fetch"===e.t0?5:"repro-precacher-update-user-annotation"===e.t0?6:"repro-precacher-prefeched-resource-usage-report"===e.t0?7:"repro-precacher-delete-by-condition"===e.t0?8:"repro-precacher-collect-garbage"===e.t0?9:"repro-precacher-stop"===e.t0?10:"repro-precacher-clear"===e.t0?11:"repro-precacher-memory-caches"===e.t0?12:"repro-precacher-all-keys"===e.t0?13:14;break;case 4:return e.abrupt("return",n.handleInitEvent(r.data));case 5:return e.abrupt("return",n.handleFetchEvent(r.data));case 6:return e.abrupt("return",n.handleUserAnnotationEvent(r.data));case 7:return e.abrupt("return",n.handleCollectTrafficReportEvent(r.data));case 8:return e.abrupt("return",n.handleDeleteByConditionEvent(r.data));case 9:return e.abrupt("return",n.handleCollectGarbageEvent(r.data));case 10:return e.abrupt("return",n.handlePrecacherStopEvent(r.data));case 11:return e.abrupt("return",n.handleClearEvent(r.data));case 12:return e.abrupt("return",n.handleMemoryCaches(r.data));case 13:return e.abrupt("return",n.handleAllKeys(r.data));case 14:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}]),t}(),sr=function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",or.receive(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ur=401;!function(e){e.NONE="none",e.HISTORY="history",e.HASH="hash"}(ir||(ir={}));var cr,lr,hr={available:"available",service_worker_url:"serviceWorkerUrl",service_worker_scope:"serviceWorkerScope",cache_limit:"cacheLimit",opaque_cache_limit:"opaqueCacheLimit",cache_config:"cacheConfig",viewport_stay_time_threshold:"viewportStayTimeThreshold",viewport_root_margins:"viewportRootMargins",mouseover_timeout:"mouseoverTimeout",unregister_on_stop:"unregisterOnStop",prefetching_exclusion_filter:"prefetchingExclusionFilter",cache_busting_trigger_url:"cacheBustingTriggerUrl",filter:"filter",control_group_rate:"controlGroupRate",google_analytics_tracking_code:"googleAnalyticsTrackingCode",allow_webview:"allowWebview",ga4_measurement_id:"ga4MeasurementId",ga4_measurement_id_for_client:"ga4MeasurementIdForClient",ga4_site_speed_sample_rate:"ga4SiteSpeedSampleRate",add_header_to_prefetch:"addHeaderToPrefetch",add_query_param_to_prefetch:"addQueryParamToPrefetch",traffic_amount:"trafficAmount",proxyConfig:"proxyConfig",prefetchPostback:"prefetchPostback"},pr=function(e){for(var t={},r=0,n=Object.keys(e||hr);r<n.length;r++){var a=n[r],i=!!e&&a in e,o=hr[a],s=i?e[a]:"available"!==o&&j[o];"cacheBustingTriggerUrl"===o&&i?t[o]=s||[]:i&&(t[o]=s)}return t},fr=function(e){var t=pr(e&&e.shared?e.shared:void 0),r=e?pr(T(e)):j,n=t.cacheBustingTriggerUrl,a=void 0===n?[]:n,i=t.filter,o=(i=void 0===i?{}:i).includes,s=void 0===o?[]:o,u=i.excludes,c=void 0===u?[]:u,l=t.prefetchingExclusionFilter,h=void 0===l?[]:l,f=t.proxyConfig,d=t.prefetchPostback,v=void 0===d?j.prefetchPostback:d,m=p(t,r);if(m.cacheBustingTriggerUrl=a.concat(r.cacheBustingTriggerUrl||[]),m.filter&&(m.filter.includes&&(m.filter.includes=s.concat(r.filter&&r.filter.includes||[])),m.filter.excludes&&(m.filter.excludes=c.concat(r.filter&&r.filter.excludes||[]))),m.prefetchingExclusionFilter&&(m.prefetchingExclusionFilter=h.concat(r.prefetchingExclusionFilter&&r.prefetchingExclusionFilter||[])),m.proxyConfig){var g,y,b,k,x,w,R,C,S,P,M,E,O,A,L,z;if(null!==(g=m.proxyConfig.imageProxy)&&void 0!==g&&g.filters)m.proxyConfig.imageProxy.filters.includes=null!==(b=null===(k=m.proxyConfig.imageProxy.filters.includes)||void 0===k||null===(x=k.concat)||void 0===x?void 0:x.call(k,null!==(w=null==f||null===(R=f.imageProxy)||void 0===R||null===(C=R.filters)||void 0===C?void 0:C.includes)&&void 0!==w?w:[]))&&void 0!==b?b:[],m.proxyConfig.imageProxy.filters.excludes=null!==(S=null===(P=m.proxyConfig.imageProxy.filters.excludes)||void 0===P||null===(M=P.concat)||void 0===M?void 0:M.call(P,null!==(E=null==f||null===(O=f.imageProxy)||void 0===O||null===(A=O.filters)||void 0===A?void 0:A.excludes)&&void 0!==E?E:[]))&&void 0!==S?S:[];if(null!==(y=m.proxyConfig.imageProxy)&&void 0!==y&&y.hosts)m.proxyConfig.imageProxy.hosts=m.proxyConfig.imageProxy.hosts.concat(null!==(L=null==f||null===(z=f.imageProxy)||void 0===z?void 0:z.hosts)&&void 0!==L?L:[])}if(m.prefetchPostback){var I,_,q,N,B,H,U,D,F,W,G,Q,K,$,X,J;if(null!==(I=m.prefetchPostback)&&void 0!==I&&null!==(_=I.filters)&&void 0!==_&&_.includes)m.prefetchPostback.filters.includes=null!==(B=null==v||null===(H=v.filters)||void 0===H||null===(U=H.includes)||void 0===U?void 0:U.concat(null!==(D=null==r||null===(F=r.prefetchPostback)||void 0===F||null===(W=F.filters)||void 0===W?void 0:W.includes)&&void 0!==D?D:[]))&&void 0!==B?B:[];if(null!==(q=m.prefetchPostback)&&void 0!==q&&null!==(N=q.filters)&&void 0!==N&&N.excludes)m.prefetchPostback.filters.excludes=null!==(G=null==v||null===(Q=v.filters)||void 0===Q||null===(K=Q.excludes)||void 0===K?void 0:K.concat(null!==($=null==r||null===(X=r.prefetchPostback)||void 0===X||null===(J=X.filters)||void 0===J?void 0:J.excludes)&&void 0!==$?$:[]))&&void 0!==G?G:[]}return m},dr=function(e){if(void 0!==e){var t,r=n(n({},e),{},{spa_mode:(t=e.spa_mode,t&&Object.values(ir).includes(t)?e.spa_mode:void 0)});return Object.entries(r).forEach((function(e){var t=f(e,2),n=t[0];void 0===t[1]&&delete r[n]})),r}},vr=function(){var e=s(regeneratorRuntime.mark((function e(t){var r,n,a,i,o,s,u,c,l,h,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.idfv&&t.token){e.next=2;break}return e.abrupt("return",Promise.reject("Aborting Configuration API call due to idfv or token missing."));case 2:if(navigator.onLine){e.next=4;break}return e.abrupt("return",Promise.reject(new Error("Aborting configuration API call due to browser being offline.")));case 4:return i=t.userAnnotation,o=void 0===i?"":i,s=t.idfv,u=t.token,c=t.previewToken,l={user_annotation:o,idfv:s,token:u,sdk_version:R,os:"web",preview_token:c},e.next=8,st(nt,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),mode:"cors"});case 8:if((h=e.sent).status!==ur){e.next=11;break}throw new Error("Configuration API call failed due to authentication error. Check your repro token.");case 11:if(h.ok){e.next=13;break}throw new Error("Configuration API call failed with status ".concat(h.status,"."));case 13:return e.next=15,h.json();case 15:if("object"==typeof(p=e.sent)){e.next=18;break}throw new Error("Invalid config response: ".concat(p));case 18:return f={messages:p.web_messages||[],trackingRules:p.tracking_rules||[],send_errors:null===(r=p.send_errors)||void 0===r||r,appId:p.insight.app_id,insightId:p.insight.id,timeOffsetMills:Date.now()-parseInt("".concat(p.responded_at,"000"),10),trackable:p.insight.trackable,ipAddress:p.insight.ip_address,dataUploadInterval:null!==(n=p.insight.data_upload_interval)&&void 0!==n?n:3e3,reconfigureInterval:null!==(a=p.insight.reconfigure_interval)&&void 0!==a?a:18e4,silverEggSetting:{merchantId:null!==p.insight.silver_egg.merchant_id?p.insight.silver_egg.merchant_id:"",domain:null!==p.insight.silver_egg.domain?p.insight.silver_egg.domain:""},precacher:fr(p.precacher),googleAnalyticsTrackingCode:"",setupOptions:dr(p.sdk_config)},null!=p.push_setting&&(f.pushSetting={serviceWorkerUrl:p.push_setting.service_worker_url,serviceWorkerScope:p.push_setting.service_worker_scope,vapidKey:p.push_setting.vapid_key}),null!=p.inspect_mode&&(f.inspect_mode=p.inspect_mode),e.abrupt("return",f);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mr=function(){function e(t){u(this,e),h(this,"error",void 0),this.error=t}var t;return l(e,null,[{key:"try",value:(t=s(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r();case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),new e(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))),function(e){return t.apply(this,arguments)})}]),e}(),gr=+new Date(3e5),yr=function(){var e=s(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.request,clearTimeout(undefined),clearTimeout(cr),cr=setTimeout(s(regeneratorRuntime.mark((function e(){var t,r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he.isDisabled();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,Re.get(G);case 7:if((t=e.sent)&&!t.ok){e.next=29;break}if(!t){e.next=15;break}return e.next=12,t.json();case 12:e.t0=e.sent,e.next=16;break;case 15:e.t0=0;case 16:if(r=e.t0,!(Date.now()>r+gr)){e.next=29;break}return e.next=20,Ae();case 20:return a=e.sent,i=a.config,i=B(i),e.next=25,mr.try(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vr(i.configApiRequestParameters));case 1:case"end":return e.stop()}}),e)}))));case 25:(o=e.sent).precacher.available&&o.trackable?he.enable():he.disable(),Re.put(U,new Response(JSON.stringify(H(o.precacher,n(n({},i.configApiRequestParameters),{},{appId:o.appId}))))),Re.put(G,new Response(JSON.stringify(Date.now())));case 29:e.next=33;break;case 31:e.prev=31,e.t1=e.catch(4);case 33:case"end":return e.stop()}}),e,null,[[4,31]])}))),1e4),e.next=5,he.isDisabled();case 5:if(!e.sent){e.next=7;break}return e.abrupt("return",mr.try(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(r));case 1:case"end":return e.stop()}}),e)})))));case 7:return e.abrupt("return",ar.fetch({request:r}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();!function(e){e.CLICK="click",e.CLICK_BUTTON_1="click_button_1",e.CLICK_BUTTON_2="click_button_2"}(lr||(lr={}));var br=ye.create("precacher");function kr(e){null!=e.internalEventGid&&caches.open("repro_cache_v1").then((function(t){var r,n=Date.now();r="show"===e.action?"".concat(b,"?action=show&internal_event_gid=").concat(e.internalEventGid,"&tracked_at=").concat(n):"".concat(b,"?action=click&internal_event_gid=").concat(e.internalEventGid,"?click_action=").concat(e.action,"&tracked_at=").concat(n),t.put(r,new Response(r))}))}self.addEventListener("push",(function(e){if(null!=e.data){var t=e.data.json();kr({action:"show",internalEventGid:t.options.data.internal_event_gid}),e.waitUntil(self.registration.showNotification(t.title,n({},t.options)))}})),self.addEventListener("install",(function(e){e.waitUntil(self.skipWaiting())})),self.addEventListener("activate",(function(e){e.waitUntil(self.clients.claim())})),self.addEventListener("notificationclick",(function(e){e.notification.close();var t=e.notification.data,r=lr.CLICK,n=null;switch(e.action){case"":n=t.notification_click_url||null;break;case e.notification.actions[0].action:r=lr.CLICK_BUTTON_1,n=t.action_click_1_url||null;break;case e.notification.actions[1].action:r=lr.CLICK_BUTTON_2,n=t.action_click_2_url||null}if(kr({action:r,internalEventGid:t.internal_event_gid}),null!=n){var a=self.clients.matchAll({type:"window",includeUncontrolled:!0}).then((function(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(r.url===n)return r.focus()}return self.clients.openWindow(n)}));e.waitUntil(a)}})),self.addEventListener("message",(function(e){e.data&&("rpr_log_level"===e.data.type&&ye.setLogLevel(e.data.name,e.data.level),e.waitUntil(sr({data:e.data,ports:e.ports})))})),self.addEventListener("fetch",(function(e){if(!(0!==(t=e.request).url.indexOf("http")||"only-if-cached"===t.cache&&"same-origin"!==t.mode||t.headers.has("range")||t.url.includes("reproio.com"))){var t,r=setTimeout((function(){br.info("Slow response",e.request)}),5e3),n=yr({request:e.request}).catch((function(t){return t instanceof mr?Promise.reject(t.error):(ot.notify({error:t instanceof Error?t:"PrecacherError: Unexpected error occured",extraPayload:{error:t,requestUrl:e.request.url},rollbarOptions:{fingerprint:new URL(e.request.url).host},referrer:"",samplingRatio:1e3}),fetch(e.request))})).finally((function(){return clearTimeout(r)}));e.respondWith(n)}}))}();
